const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/9c5a2fed-i87mar6blea3r5wu.js","assets/2340486e-n0khdanno9uzbccp.js","assets/4813494d-di0bpg5zidu9s57f.js","assets/root-jvstnck2.css","assets/1a7ebd5f-ihenykhpblfwilpu.js","assets/conversation-small-dnpfu486.css","assets/6ee9bd33-fiv0sobiw51j22vu.js","assets/a78f4c52-cw7jzavtuf7x7wvs.js","assets/64696494-o6c5oajkrzkue30b.js","assets/16d1c905-dr9kvinvs53n9t17.js","assets/4b303e9e-j4t54vnx5tc5zz5q.js","assets/25de328f-jjnjhtdt1jkryrzu.js","assets/7bce51e5-d3urq6cpyoxry80a.js","assets/b18a606b-c6zms491ydufo909.js","assets/17a4a3eb-kwqy8y9l1juxuewg.js","assets/7f23f398-iphhb0bkgf1z2kvu.js","assets/032c3459-gfpqyhflsla4h6p6.js","assets/b4a77cb4-c5klrwo0der0fjar.js","assets/25e69e8b-gbkmmqarwkyhthql.js","assets/b81d67c1-g85xaexv7seu9n1r.js","assets/b9ebfa06-o5t8gt8380co00ia.js","assets/e0921b7a-d80kbpu52j6pqerp.js","assets/d9bdd822-bhx2k4b9vfts364u.js","assets/4dd72076-gz0ay81h2u0ca0qp.js","assets/60be9861-jfwj0qim08m9lxod.js","assets/1de975ca-opfq6f6nav5b4m2m.js"])))=>i.map(i=>d[i]);
var Zo=Object.freeze,er=Object.defineProperty,Vc=Object.defineProperties;var Gc=Object.getOwnPropertyDescriptors;var Wn=Object.getOwnPropertySymbols;var sr=Object.prototype.hasOwnProperty,tr=Object.prototype.propertyIsEnumerable;var Jo=(t,e,s)=>e in t?er(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,W=(t,e)=>{for(var s in e||(e={}))sr.call(e,s)&&Jo(t,s,e[s]);if(Wn)for(var s of Wn(e))tr.call(e,s)&&Jo(t,s,e[s]);return t},fe=(t,e)=>Vc(t,Gc(e));var nr=(t,e)=>{var s={};for(var i in t)sr.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(t!=null&&Wn)for(var i of Wn(t))e.indexOf(i)<0&&tr.call(t,i)&&(s[i]=t[i]);return s};var zn=(t,e)=>Zo(er(t,"raw",{value:Zo(e||t.slice())}));import{d as ea,c as Ge,b as Bs,a as $c,r as v,j as n,n as Or,h as di,M as te,_ as Us}from"./2340486e-n0khdanno9uzbccp.js";import{ds as rs,dq as Q,aS as nt,aT as at,P as ve,e$ as Br,e8 as ui,mk as Wc,lm as sa,gE as Ue,ln as ta,t as zc,b as _e,aC as na,Bk as qc,ax as gi,w9 as Ur,b2 as Vr,l8 as it,Bl as Yc,cd as Qc,dV as Kc,u5 as Xc,ct as mi,fQ as fi,hW as Zn,gf as Zc,bu as Jc,eH as Gr,h as ue,aW as Ve,le as $r,b3 as ed,fa as Xe,bp as Vs,F as hi,jb as B,jH as Wr,dW as se,Bm as zr,aR as sd,pX as td,ej as Be,dA as Ze,dJ as pi,dt as Os,qz as nd,am as Jn,kd as qr,R as ad,A as id,az as ar,al as ni,dR as Yr,df as Qr,v as od,bh as Ne,ff as Kr,mC as Xr,sK as rd,sL as ld,tt as cd,sM as dd,mn as ud,eG as gd,i6 as md,lw as fd,e as Zr,dm as hd,Bn as pd,J as xd,c$ as _d,e_ as ir,k6 as Kn,jM as vd,n4 as yd,dH as bd,l as Fs,q4 as Sd,fd as Td,ma as wd,h2 as Id,e5 as or,H as ei,cO as kd,gp as jd,du as Ls,Bo as Cd,cQ as Jr,mt as Ad,eQ as Ed,dI as rr,Bp as lr,hI as Pd,Bq as Md,e0 as el,Br as Nd,Bs as Rd,bi as Fd,lC as qn,dD as Ld,fB as ai,k as Hd,W as Dd,hk as Od,nY as Bd,d as sl,jL as Ud,k4 as xi,dZ as Vd,jY as Gd,jZ as $d,ga as Wd,g9 as zd,fR as cr,nC as qd,dp as Yd,ev as Xn,ef as Qd,tb as Kd,q2 as Xd,pu as Zd,eg as Jd,q1 as eu,gB as su,k8 as tu,cB as nu,qU as au}from"./4813494d-di0bpg5zidu9s57f.js";import{xe as iu,a1 as ou,l as tl,A as ii,o as ru,xf as lu,kj as cu,s6 as du,xg as uu,xh as nl,xi as al,xj as il,xk as gu,xl as ol,xm as mu,xn as fu,xo as hu,nd as rl,xp as ll,jJ as pu,pU as xu,xq as dr,cZ as _u,xr as ur,xs as vu,xt as gr,xu as yu,c1 as tt,dS as Ds,bX as bu,cM as Su,ce as Tu,xv as wu,xw as cl,xx as Iu,P as dl,l0 as ku,bY as ju,xy as Cu,xz as Au,bu as Eu,bv as Pu,xA as Mu,xB as Nu,xC as Ru,xD as mr,xE as Fu,xF as Yn,xG as si,xH as Hs,xI as fr,xJ as Lu,xK as Hu,iS as ul,f2 as Du,f3 as Ou,xL as Bu,nF as Uu,xM as Vu,f5 as Gu,a5 as gl,xN as $u,l3 as Wu,xO as hr,xP as zu,xQ as qu,ny as Yu,s4 as Qu,xR as Ku,xS as Xu,xT as Zu,xU as pr,xV as Ju,m6 as eg,xW as sg,xX as tg,xY as ng,pn as ag,ep as ig,xZ as og,x_ as rg,x$ as lg,y0 as cg,y1 as dg,y2 as ug,au as ml,y3 as gg,y4 as mg,y5 as fg,y6 as hg,y7 as xr,y8 as pg,y9 as xg,ya as _g,yb as vg,yc as yg,yd as _r,ye as bg,yf as Sg,yg as Tg,yh as wg,yi as Ig,iy as kg,av as jg,yj as Cg,yk as Ag,at as Eg,yl as Pg,ym as Mg,yn as Ng,a3 as Rg,rL as Fg,fG as fl,yo as Lg,yp as Hg,e5 as hl,ar as Dg,eK as Og,yq as Bg,yr as Ug,qb as Vg,ys as Gg,yt as $g,yu as Wg,yv as zg,yw as qg,bW as Yg,yx as Qg,tE as Kg,yy as Xg,iU as Zg,iW as Jg,yz as em,yA as sm,hZ as tm,kR as nm,yB as am,yC as im,yD as om,yE as rm,yF as lm}from"./1a7ebd5f-ihenykhpblfwilpu.js";import{d as pl,r as cm,k as dm,a as oi}from"./84e8f385-egf9uxe7ipj6bm36.js";import{b as um}from"./1893e499-abqgac27ymh8ltab.js";import{C as ri}from"./9ed9a415-dm4br15ut09gdl61.js";import{r as xl}from"./b81d67c1-g85xaexv7seu9n1r.js";import{u as _l}from"./4b9386ba-i47pf4ceaol018kk.js";import{M as gm,O as mm}from"./9bee0952-fxdbwwdrjo8v2f2i.js";import{l as fm}from"./6fd89734-d6icu94x1k3basy7.js";import{a as hm,b as pm}from"./97587f90-ob9hx1q3ilf6g3xt.js";const _i=({intl:t,conversation:e,systemHint:s,targetedReplyLabel:i})=>{var m,_;const a=s.systemHint,l=rs(e.id),o=Q.getParentPromptNode(l);if(!o)return;const d=(m=s==null?void 0:s.actionLabel)!=null?m:s==null?void 0:s.name;nt.count(at.ECOSYSTEM,"suggestion_hint_followup_turn_triggered"),ve.logEventWithStatsig("Ecosystem app: Suggestion hint followup turn triggered","chatgpt_web_ecosystem_suggestion_hint_followup_turn_triggered",W({system_hint:a},d?{system_hint_label:d}:{}));const c=[a],r=d?t.formatMessage(vr.usedSystemHint,{systemHint:d}):t.formatMessage(vr.usedSystemHintGeneric),g=Br(o.message.content,fe(W({},o.message.metadata),{system_hints:c,is_visually_hidden_from_conversation:!0,triggered_by_system_hint_suggestion:!0,targeted_reply_label:i!=null?i:r}));o&&xl({promptMessage:g,completionMetadata:{systemHints:c,conversationMode:(_=l==null?void 0:l.mode)!=null?_:{kind:ui.PrimaryAssistant}},eventSource:"mouse",conversation:e}),a&&Wc(a)&&sa(a,ta.SuggestionAccept,Ue({clientThreadId:e.id}))},vr=ea({usedSystemHint:{id:"pwHqiX",defaultMessage:"Used {systemHint}"},usedSystemHintGeneric:{id:"wbs4BT",defaultMessage:"Used tool"}}),xm=t=>{"use forget";const e=Ge.c(15),{actionLabel:s,subtitle:i,onClick:a,disabled:l}=t,o=l===void 0?!1:l;let d;e[0]===Symbol.for("react.memo_cache_sentinel")?(d=n.jsx(cu,{showBackground:!0,className:"h-8 w-8 pt-0.5","aria-hidden":!0}),e[0]=d):d=e[0];let c;e[1]!==s?(c=n.jsx("span",{className:"text-token-text-primary text-base font-normal",children:s}),e[1]=s,e[2]=c):c=e[2];let r;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx(gi,{className:"text-token-text-primary h-4 w-4","aria-hidden":!0}),e[3]=r):r=e[3];let g;e[4]!==c?(g=n.jsxs("div",{className:"flex items-center gap-1",children:[c,r]}),e[4]=c,e[5]=g):g=e[5];let m;e[6]!==i?(m=n.jsx("span",{className:"text-token-text-tertiary text-sm",children:i}),e[6]=i,e[7]=m):m=e[7];let _;e[8]!==g||e[9]!==m?(_=n.jsxs("div",{className:"flex flex-1 flex-col gap-0.5",children:[g,m]}),e[8]=g,e[9]=m,e[10]=_):_=e[10];let f;return e[11]!==o||e[12]!==a||e[13]!==_?(f=n.jsxs("button",{type:"button",onClick:a,disabled:o,className:"hover:bg-token-main-surface-secondary focus:bg-token-main-surface-secondary inline-flex max-w-full items-center gap-3 rounded-xl px-3 py-2 text-start transition",children:[d,_]}),e[11]=o,e[12]=a,e[13]=_,e[14]=f):f=e[14],f},yr=ea({actionLabel:{id:"kTtbc2",defaultMessage:"Continue with Health"},subtitle:{id:"KDIvbk",defaultMessage:"Get more personalized responses in Health, where ChatGPT has access to more of your health and wellness data."}}),_m=t=>{"use forget";const e=Ge.c(26),{conversation:s,suggestedContextScope:i,actionLabel:a}=t,l=Bs(),o=zc(),d=$c(),c=iu(),r=ou(),[g,m]=v.useState(!1);let _;e[0]!==s.id?(_=rs(s.id),e[0]=s.id,e[1]=_):_=e[1];const f=_,y=(f==null?void 0:f.mode.kind)===ui.GizmoInteraction?f.mode.gizmo_id:null;let h;e[2]!==a||e[3]!==l?(h=a!=null?a:l.formatMessage(yr.actionLabel),e[2]=a,e[3]=l,e[4]=h):h=e[4];const S=h;let w;e[5]!==l?(w=l.formatMessage(yr.subtitle),e[5]=l,e[6]=w):w=e[6];const I=w;let k;e[7]===Symbol.for("react.memo_cache_sentinel")?(k=qc("HEALTH"),e[7]=k):k=e[7];const M=k,N=i==="HEALTH",{eligible:A,isLoading:T}=tl(ii.Onboarding),E=_e(vm);let R;e[8]!==o||e[9]!==s||e[10]!==y||e[11]!==E||e[12]!==S||e[13]!==l||e[14]!==g||e[15]!==A||e[16]!==T||e[17]!==d||e[18]!==c||e[19]!==r?(R=()=>{if(g)return;nt.count(at.ECOSYSTEM,"health_scope_suggestion_clicked",{scope:"health"}),m(!0);const H=()=>m(!1);if(cm(o)==="health"&&A&&!T&&!E){dm.set(!0),pl.set(!1),ru(ii.Onboarding).catch(ym).then(H,H);return}(async()=>{await c()==="dismissed"||!await lu({clientThreadId:s.id,gizmoId:y,updateConversationGizmo:r,queryClient:d})||_i({intl:l,conversation:s,systemHint:{actionLabel:S,systemHint:M,name:S},targetedReplyLabel:S})})().catch(bm).then(H,H)},e[8]=o,e[9]=s,e[10]=y,e[11]=E,e[12]=S,e[13]=l,e[14]=g,e[15]=A,e[16]=T,e[17]=d,e[18]=c,e[19]=r,e[20]=R):R=e[20];const p=na(R);if(!N)return null;let G;return e[21]!==S||e[22]!==I||e[23]!==g||e[24]!==p?(G=n.jsx("div",{className:"border-token-border-light my-2 border-t pt-4",children:n.jsx(xm,{actionLabel:S,subtitle:I,onClick:p,disabled:g})}),e[21]=S,e[22]=I,e[23]=g,e[24]=p,e[25]=G):G=e[25],G};function vm(){return pl()===!0}function ym(){}function bm(t){throw nt.count(at.ECOSYSTEM,"health_scope_activation_failed"),t}const vl=({conversation:t,connectorIds:e})=>{"use no forget";const s=Bs(),i=Vr(),a=_e(()=>Ur(i)),l=na(f=>{var y,h;_.current||(_.current=!0,_i({intl:s,conversation:t,systemHint:{name:f.name,systemHint:it(f.id)},targetedReplyLabel:(h=(y=f.suggestion_config)==null?void 0:y.targeted_reply_label)!=null?h:null}))}),[o,d]=Or(),c=o.get(Yc)==="true",r=o.get("oauth_success"),g=o.get("connector_id"),m=du(Qc()).current,_=v.useRef(!1);v.useEffect(()=>{if(!r||!g||!e.includes(g))return;const f=a==null?void 0:a.get(g);f&&(l(f),d(y=>(y.delete("oauth_success"),y.delete("system_hint"),y.delete("connector_id"),y)))},[r,d,l,e,g,a]),v.useEffect(()=>{if(!c||!m||!e.includes(m))return;const f=a==null?void 0:a.get(m);f&&l(f)},[c,e,m,l,a])},yl=({connector:t,conversation:e,suggestionMessageId:s,hasLink:i,targetedReplyLabel:a,persistedSystemHintsStore:l,navigate:o,intl:d})=>{const c=t.id;nt.count(at.ECOSYSTEM,"suggestion_hint_clicked"),sa(it(c),ta.SuggestionClick,Ue({clientThreadId:e.serverId$(),messageId:s}));const r=e.serverId$();if(r&&uu({conversationId:r,messageId:s,connectorId:c,eventType:"click"}),i)_i({intl:d,conversation:e,systemHint:{name:t.name,systemHint:it(c)},targetedReplyLabel:a});else{nt.count(at.ECOSYSTEM,"inline_message_suggestion_connect_modal_opened"),ve.logEventWithStatsig("Ecosystem app: Inline message suggestion connect modal opened","chatgpt_web_ecosystem_inline_message_suggestion_connect_modal_opened");const g=e.serverId$(),m=g?new URL(Kc(g),window.location.origin):new URL(window.location.href);m.searchParams.set("connector_id",c),m.searchParams.set("oauth_success","true");const _=l.getActiveSystemHintType();_&&m.searchParams.set("system_hint",_);const f=t.supported_auth.length===1&&t.supported_auth[0].type==="OAUTH"?"OAUTH":void 0;o(Xc({connectorId:c,authTypeOverride:f,redirectAfter:m.toString(),referrer:mi.MessageSuggestion,showSettingsBehindConnectorLink:!1}),{replace:!0})}},Sm=()=>null,Tm=t=>{"use forget";const e=Ge.c(55),{conversation:s,connector:i,suggestionMessageId:a,hasLink:l,callToAction:o,callToActionSubtitle:d,imageUrl:c,targetedReplyLabel:r}=t,g=v.useRef(!1);let m,_;e[0]!==i.id||e[1]!==s||e[2]!==a?(m=()=>{g.current||(g.current=!0,sa(it(i.id),ta.SuggestionTrigger,Ue({clientThreadId:s.serverId$(),messageId:a})),$r.logEntryPointShown({referrer:mi.MessageSuggestion}))},_=[i.id,s,a],e[0]=i.id,e[1]=s,e[2]=a,e[3]=m,e[4]=_):(m=e[3],_=e[4]),v.useEffect(m,_);let f;e[5]!==i.id?(f=[i.id],e[5]=i.id,e[6]=f):f=e[6];const y=f;let h;e[7]!==s||e[8]!==y?(h={conversation:s,connectorIds:y},e[7]=s,e[8]=y,e[9]=h):h=e[9],vl(h);const S=Bs(),w=di(),I=Gr.useStore();let k;e[10]!==i||e[11]!==s||e[12]!==l||e[13]!==S||e[14]!==w||e[15]!==I||e[16]!==a||e[17]!==r?(k=()=>{yl({connector:i,conversation:s,suggestionMessageId:a,hasLink:l,targetedReplyLabel:r,persistedSystemHintsStore:I,intl:S,navigate:w})},e[10]=i,e[11]=s,e[12]=l,e[13]=S,e[14]=w,e[15]=I,e[16]=a,e[17]=r,e[18]=k):k=e[18];const M=na(k),{logo_url:N,logo_url_dark:A}=i;let T;e[19]!==N||e[20]!==A?(T={lightLogoUrl:N,darkLogoUrl:A},e[19]=N,e[20]=A,e[21]=T):T=e[21];const{data:E}=rl(T),R=c!=null?c:E==null?void 0:E.url,[p,G]=v.useState(!1);let H,D,$;e[22]===Symbol.for("react.memo_cache_sentinel")?(D={opacity:0},$={opacity:1},H={delay:.1,duration:.5,type:"spring"},e[22]=H,e[23]=D,e[24]=$):(H=e[22],D=e[23],$=e[24]);let z;e[25]!==c||e[26]!==p||e[27]!==R?(z=R&&n.jsx("div",{className:ue("flex items-center justify-center overflow-hidden",!p&&"shimmer",c?"h-12 w-12 rounded-lg":ue("bg-token-bg-primary h-10 w-10 rounded-xl","shadow-[0_0_0_0.5px_rgba(0,0,0,0.05),0_0.5px_1px_0_rgba(0,0,0,0.09),0_5px_8px_-3px_rgba(0,0,0,0.05)]","dark:shadow-[0_0_0_0.5px_rgba(255,255,255,0.05),0_0.5px_1px_0_rgba(255,255,255,0.09),0_5px_8px_-3px_rgba(255,255,255,0.05)]")),children:n.jsx("img",{className:ue("object-contain",c?"h-full w-full":"h-8 w-8 overflow-hidden rounded-lg"),src:R,"aria-hidden":"true",onLoad:()=>{G(!0)}})}),e[25]=c,e[26]=p,e[27]=R,e[28]=z):z=e[28];let K;e[29]!==o?(K=n.jsx("span",{className:"truncate",children:o}),e[29]=o,e[30]=K):K=e[30];let X;e[31]===Symbol.for("react.memo_cache_sentinel")?(X=n.jsx(gi,{className:"icon-sm ms-1 shrink-0","aria-hidden":!0}),e[31]=X):X=e[31];let b;e[32]!==K?(b=n.jsxs("span",{className:"text-token-text-primary inline-flex items-center text-base",children:[K,X]}),e[32]=K,e[33]=b):b=e[33];let U;e[34]!==d||e[35]!==i.name||e[36]!==E||e[37]!==c?(U=c&&!d&&n.jsx("span",{className:"h-4.5 w-4.5 shrink-0 overflow-hidden rounded-md",children:(E==null?void 0:E.url)&&n.jsx("img",{src:E.url,className:"h-full w-full",alt:i.name})}),e[34]=d,e[35]=i.name,e[36]=E,e[37]=c,e[38]=U):U=e[38];let ne;e[39]!==d||e[40]!==i.name||e[41]!==l?(ne=d||(l?n.jsx(te,{id:"6RY8V3",defaultMessage:"Use {connectorName}",values:{connectorName:i.name}}):n.jsx(te,{id:"tbpdYd",defaultMessage:"Connect {connectorName}",values:{connectorName:i.name}})),e[39]=d,e[40]=i.name,e[41]=l,e[42]=ne):ne=e[42];let J;e[43]!==ne?(J=n.jsx("span",{className:"text-token-text-tertiary group-hover:text-token-text-secondary truncate text-sm",children:ne}),e[43]=ne,e[44]=J):J=e[44];let Y;e[45]!==U||e[46]!==J?(Y=n.jsxs("div",{className:"flex flex-1 items-start gap-2",children:[U,J]}),e[45]=U,e[46]=J,e[47]=Y):Y=e[47];let ae;e[48]!==b||e[49]!==Y?(ae=n.jsxs("div",{className:"flex flex-col items-start gap-1 pe-2",children:[b,Y]}),e[48]=b,e[49]=Y,e[50]=ae):ae=e[50];let u;return e[51]!==M||e[52]!==z||e[53]!==ae?(u=n.jsxs(Ve.button,{initial:D,animate:$,transition:H,type:"button",className:"group after:bg-token-bg-secondary relative z-10 flex items-center gap-4 after:absolute after:-inset-2 after:z-[-1] after:hidden after:rounded-xl after:opacity-50 after:content-[''] hover:after:block",onClick:M,children:[z,ae]}),e[51]=M,e[52]=z,e[53]=ae,e[54]=u):u=e[54],u},wm=t=>{"use forget";const e=Ge.c(31),{conversation:s,connectorIds:i,messages:a,suggestionMessageId:l,suggestedContextScope:o,suggestedContextScopeActionLabel:d,suggestedFirstPartyProjectType:c,suggestedFirstPartyProjectTypeActionLabel:r}=t,{platformConnectors:g}=Zc(),{connectorLinks:m}=Jc();let _;e[0]!==a?(_=fu(a),e[0]=a,e[1]=_):_=e[1];const f=_;let y;e[2]!==a?(y=hu(a),e[2]=a,e[3]=y):y=e[3];const h=y;if(o){let k;return e[4]!==s||e[5]!==o||e[6]!==d?(k=n.jsx(_m,{conversation:s,suggestedContextScope:o,actionLabel:d}),e[4]=s,e[5]=o,e[6]=d,e[7]=k):k=e[7],k}if(c){let k;return e[8]!==s||e[9]!==c||e[10]!==r?(k=n.jsx(Sm,{conversation:s,suggestedProjectType:c,actionLabel:r}),e[8]=s,e[9]=c,e[10]=r,e[11]=k):k=e[11],k}if(!l||!i.length)return null;const S=i.length>1;let w;if(e[12]!==i||e[13]!==m||e[14]!==s||e[15]!==h||e[16]!==f||e[17]!==S||e[18]!==g||e[19]!==l){let k;e[21]!==m||e[22]!==s||e[23]!==h||e[24]!==f||e[25]!==S||e[26]!==g||e[27]!==l?(k=M=>{var R,p,G,H;const N=g.get(M);if(!N||!M)return null;const A=N.suggestion_config,T=(R=f[M])!=null?R:A==null?void 0:A.call_to_action,E=(p=h[M])!=null?p:A==null?void 0:A.call_to_action_subtitle;return!A||!T?null:n.jsx(Tm,{conversation:s,connector:N,hasLink:m.has(M),callToAction:T,callToActionSubtitle:E!=null?E:null,targetedReplyLabel:(G=A.targeted_reply_label)!=null?G:null,imageUrl:S?null:(H=A.image_url)!=null?H:null,suggestionMessageId:l},M)},e[21]=m,e[22]=s,e[23]=h,e[24]=f,e[25]=S,e[26]=g,e[27]=l,e[28]=k):k=e[28],w=i.map(k),e[12]=i,e[13]=m,e[14]=s,e[15]=h,e[16]=f,e[17]=S,e[18]=g,e[19]=l,e[20]=w}else w=e[20];let I;return e[29]!==w?(I=n.jsx("div",{className:"border-token-border-light my-2 flex gap-10 border-t pt-4",children:w}),e[29]=w,e[30]=I):I=e[30],I},Im=t=>{"use forget";const e=Ge.c(24),{isCompletionRequestInProgress:s,conversation:i,messages:a}=t;let l;e[0]!==a?(l=nl(a),e[0]=a,e[1]=l):l=e[1];const o=l;let d;e[2]!==a?(d=al(a),e[2]=a,e[3]=d):d=e[3];const c=d;let r;e[4]!==a?(r=il(a),e[4]=a,e[5]=r):r=e[5];const g=r;let m;e[6]!==a?(m=gu(a),e[6]=a,e[7]=m):m=e[7];const _=m;let f;e[8]!==a?(f=ol(a),e[8]=a,e[9]=f):f=e[9];const y=f;let h;e[10]!==a?(h=mu(a),e[10]=a,e[11]=h):h=e[11];const S=h;let w;e[12]!==o||e[13]!==i||e[14]!==s||e[15]!==a||e[16]!==g||e[17]!==_||e[18]!==y||e[19]!==S||e[20]!==c?(w=!s&&c&&n.jsx(wm,{conversation:i,connectorIds:o,suggestionMessageId:c,messages:a,suggestedContextScope:g,suggestedContextScopeActionLabel:_,suggestedFirstPartyProjectType:y,suggestedFirstPartyProjectTypeActionLabel:S},"message-suggestion"),e[12]=o,e[13]=i,e[14]=s,e[15]=a,e[16]=g,e[17]=_,e[18]=y,e[19]=S,e[20]=c,e[21]=w):w=e[21];let I;return e[22]!==w?(I=n.jsx(fi,{name:"EcosystemMessageSuggestion",children:n.jsx(Zn,{children:w})}),e[22]=w,e[23]=I):I=e[23],I},km=t=>{"use forget";const e=Ge.c(32),{connectorIds:s,suggestionMessageId:i,conversation:a}=t;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=Vr(),e[0]=l):l=e[0];const o=l;let d;e[1]===Symbol.for("react.memo_cache_sentinel")?(d=()=>Ur(o),e[1]=d):d=e[1];const c=_e(d);let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=()=>ed(o),e[2]=r):r=e[2];const{data:g}=_e(r);let m;e[3]!==s||e[4]!==a?(m={conversation:a,connectorIds:s},e[3]=s,e[4]=a,e[5]=m):m=e[5],vl(m);const _=Gr.useStore(),f=Bs(),y=di();let h;e[6]!==g||e[7]!==a||e[8]!==f||e[9]!==y||e[10]!==_||e[11]!==i?(h=T=>{var E,R;return yl({connector:T,conversation:a,suggestionMessageId:i!=null?i:"",hasLink:!!(g!=null&&g.has(T.id)),targetedReplyLabel:(R=(E=T.suggestion_config)==null?void 0:E.targeted_reply_label)!=null?R:null,persistedSystemHintsStore:_,intl:f,navigate:y})},e[6]=g,e[7]=a,e[8]=f,e[9]=y,e[10]=_,e[11]=i,e[12]=h):h=e[12];const S=h;if(!i||s.length===0)return null;let w;e[13]===Symbol.for("react.memo_cache_sentinel")?(w=n.jsx(pu,{className:"icon-md"}),e[13]=w):w=e[13];let I;e[14]===Symbol.for("react.memo_cache_sentinel")?(I=n.jsx(Xe.Trigger,{asChild:!0,children:n.jsxs("button",{className:"bg-token-bg-primary hover:bg-token-bg-secondary text-token-text-secondary flex w-fit items-center gap-1.5 py-1 ps-2 pe-3",children:[w,n.jsx("span",{className:"text-sm font-medium",children:n.jsx(te,{id:"t32e+H",defaultMessage:"Apps"})})]})}),e[14]=I):I=e[14];let k;e[15]===Symbol.for("react.memo_cache_sentinel")?(k=n.jsx(Xe.Label,{children:n.jsx(te,{id:"XN9uZU",defaultMessage:"ChatGPT Apps relevant to your chat"})}),e[15]=k):k=e[15];let M;if(e[16]!==s||e[17]!==g||e[18]!==a||e[19]!==S||e[20]!==c||e[21]!==i){let T;e[23]!==g||e[24]!==a||e[25]!==S||e[26]!==c||e[27]!==i?(T=E=>{const R=c==null?void 0:c.get(E);return!R||!R.suggestion_config?null:n.jsx(jm,{connector:R,conversation:a,suggestionMessageId:i,hasLink:!!(g!=null&&g.has(E)),onClick:()=>S(R)},E)},e[23]=g,e[24]=a,e[25]=S,e[26]=c,e[27]=i,e[28]=T):T=e[28],M=s.map(T),e[16]=s,e[17]=g,e[18]=a,e[19]=S,e[20]=c,e[21]=i,e[22]=M}else M=e[22];let N;e[29]===Symbol.for("react.memo_cache_sentinel")?(N=n.jsx(Xe.Group,{children:n.jsx(Xe.LinkItem,{external:!0,to:"/apps",children:n.jsx(te,{id:"wZW8OW",defaultMessage:"Explore more apps"})})}),e[29]=N):N=e[29];let A;return e[30]!==M?(A=n.jsxs(Xe.Root,{children:[I,n.jsx(Xe.Portal,{children:n.jsxs(Xe.Content,{align:"start",side:"top",className:"w-[345px]",children:[k,M,N]})})]}),e[30]=M,e[31]=A):A=e[31],A},jm=({conversation:t,suggestionMessageId:e,connector:s,hasLink:i,onClick:a})=>{"use no forget";const{logo_url:l,logo_url_dark:o}=s,{data:d}=rl({lightLogoUrl:l,darkLogoUrl:o}),[c,r]=v.useState(!1);return v.useEffect(()=>{sa(it(s.id),ta.SuggestionTrigger,Ue({clientThreadId:t.serverId$(),messageId:e})),$r.logEntryPointShown({referrer:mi.MessageSuggestion})},[]),n.jsxs(Xe.Item,{className:"group relative z-10 flex items-center gap-2 pe-2!",onClick:a,children:[n.jsx("div",{className:ue("flex h-6 w-6 items-center justify-center overflow-hidden rounded-md","shadow-[0_0_0_0.5px_rgba(0,0,0,0.05),0_0.5px_1px_0_rgba(0,0,0,0.09),0_5px_8px_-3px_rgba(0,0,0,0.05)]","dark:shadow-[0_0_0_0.5px_rgba(255,255,255,0.05),0_0.5px_1px_0_rgba(255,255,255,0.09),0_5px_8px_-3px_rgba(255,255,255,0.05)]",c?"bg-token-bg-primary":"bg-token-bg-tertiary"),children:(d==null?void 0:d.url)&&n.jsx("img",{className:"h-full w-full object-contain",src:d.url,"aria-hidden":"true",onLoad:()=>{r(!0)}})}),n.jsx("div",{className:"text-token-text-primary inline-flex items-center text-base",children:n.jsx("span",{className:"truncate",children:s.name})}),n.jsx("div",{className:"ms-auto hidden group-hover:block",children:n.jsx("div",{className:"text-token-text-secondary pe-1 text-sm font-medium",children:i?n.jsx(te,{id:"2rjxSK",defaultMessage:"Use"}):n.jsx(te,{id:"C2p7lo",defaultMessage:"Connect"})})})]})},Cm=t=>{"use forget";const e=Ge.c(10),{messages:s,conversation:i}=t;let a;e[0]!==s?(a=ll(s),e[0]=s,e[1]=a):a=e[1];const l=a;let o;e[2]!==s?(o=al(s),e[2]=s,e[3]=o):o=e[3];const d=o;let c;e[4]!==l||e[5]!==i||e[6]!==d?(c=l.length&&d&&n.jsx(km,{connectorIds:l,suggestionMessageId:d,conversation:i}),e[4]=l,e[5]=i,e[6]=d,e[7]=c):c=e[7];let r;return e[8]!==c?(r=n.jsx(fi,{name:"EcosystemMessageSuggestionPill",children:c}),e[8]=c,e[9]=r):r=e[9],r},br=Vs(()=>Us(()=>import("./9c5a2fed-i87mar6blea3r5wu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])).then(t=>t.MemoryActionResult));function Sr(t,e,s){Ze(t,i=>{pi.updateTree(i,a=>{a.updateNodeMetadata(e,{inlineComparisonRating:s})})})}const Tr=({messages:t})=>{for(const{metadata:e}of t){const{paragen_display_label:s}=e!=null?e:{};if(s)return s;const{augmented_paragen_prompt_label:i}=e!=null?e:{};if(i)return i}};function wr({displayedMessages:t,message:e,conversationTurnMountTime:s,visibilityState:i}){var o,d;const a={},l=((o=e.clientMetadata)==null?void 0:o.variantsInStreamInfo)==null&&((d=e.metadata)==null?void 0:d.paragen_variants_info)!=null;return t.forEach((c,r)=>{const g=l?{load_first_token_time:s,load_end_time:s}:{load_first_token_time:c.loadFirstTokenTime,load_end_time:c.loadEndTime},m=r===0?{rendered_height:i.left_rendered_height}:{rendered_height:i.right_rendered_height};a[c.messageId]=W(W({},g),m)}),a}function Am(t){const e=v.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null,left_rendered_height:null,right_rendered_height:null}),s=v.useRef({left:null,right:null});return t.variantIds.length<2?n.jsx(bl,W({setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:e,firstVisibleTokenTimestampsRef:s},t)):n.jsx(Em,fe(W({},t),{visibilityStateRef:e,firstVisibleTokenTimestampsRef:s}))}function Em(t){const{conversation:e,variantIds:s,turnIndex:i,firstVisibleTokenTimestampsRef:a}=t;if(s.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const l=zr(),o=sd(),[d,c]=s,r=v.useMemo(()=>td(d+c)()>=.5,[d,c]),[g,m]=r?[c,d]:[d,c],[_,f,y]=Be(e.id,M=>{var G,H,D,$,z,K,X,b,U,ne,J,Y,ae,u,ie,ee,Z,ye,le,q;const N=ar(M).tree.getLeafFromNode(g).id,A=ar(M).tree.getLeafFromNode(m).id,T=Q.getConversationTurns(M,N),E=Q.getConversationTurns(M,A),R=i<T.length?T[i]:null,p=i<E.length?E[i]:null;return R||ni.addError("Paragen Left turn index ".concat(i," out of bounds"),{turnIndex:i,turnCount:T.length,lastTurnRole:(G=B(T))==null?void 0:G.role,lastMessageAuthor:(D=B((H=B(T))==null?void 0:H.messages))==null?void 0:D.author,lastMessageContentType:(z=B(($=B(T))==null?void 0:$.messages))==null?void 0:z.content.content_type,lastMessageMetadata:(X=B((K=B(T))==null?void 0:K.messages))==null?void 0:X.metadata,altTurnCount:E.length,altLastTurnRole:(b=B(E))==null?void 0:b.role,altLastMessageRole:(ne=B((U=B(E))==null?void 0:U.messages))==null?void 0:ne.author.role}),p||ni.addError("Paragen Right turn index ".concat(i," out of bounds"),{turnIndex:i,turnCount:E.length,lastTurnRole:(J=B(E))==null?void 0:J.role,lastMessageAuthor:(ae=B((Y=B(E))==null?void 0:Y.messages))==null?void 0:ae.author,lastMessageContentType:(ie=B((u=B(E))==null?void 0:u.messages))==null?void 0:ie.content.content_type,lastMessageMetadata:(Z=B((ee=B(E))==null?void 0:ee.messages))==null?void 0:Z.metadata,altTurnCount:T.length,altLastTurnRole:(ye=B(T))==null?void 0:ye.role,altLastMessageRole:(q=B((le=B(T))==null?void 0:le.messages))==null?void 0:q.author.role}),[N,R,p]}),[h,S]=r?[y,f]:[f,y],w="skippable_parallel_2_in_stream:a:1.5";v.useEffect(()=>(gr.setState({displayingSideBySideFeedback:!0}),()=>{gr.setState({displayingSideBySideFeedback:!1})}),[]);const I=v.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null,left_rendered_height:null,right_rendered_height:null}),k=v.useCallback((M,{shouldSubmitParagenFeedback:N=!0}={})=>{if(!f||!y||!h||!S)throw new Error("Expected both turns to exist");Ze(e.id,D=>{pi.setCurrentBranch(D,M)});const A=M===g,T=M===d;h.messages.length>0&&Sr(e.id,h.messages[h.messages.length-1].id,T?"original":"new"),S.messages.length>0&&Sr(e.id,S.messages[S.messages.length-1].id,T?"original":"new");const E=Os(e.id),R=[f,y].map((D,$)=>{var z,K,X;return{messageId:D.messages[D.messages.length-1].id,loadFirstTokenTime:$===0?a.current.left:a.current.right,loadEndTime:(X=(K=(z=B(D.messages))==null?void 0:z.clientMetadata)==null?void 0:K.completionSampleFinishTime)!=null?X:null}}),p=A?R[0].messageId:R[1].messageId,G=Q.getParentPromptNode(rs(e.id),_);if(!G)throw new Error("Expected prompt for side by side feedback");const H=wr({displayedMessages:R,message:G.message,conversationTurnMountTime:t.conversationTurnMountTime,visibilityState:I.current});N&&Ar({params:{conversation_id:E,displayed_message_ids:R.map(D=>D.messageId),message_metadatas:H,rating:"selected",selected_message_id:p,source_timestamp:Date.now(),ui_variant:1,user_prompt_message_id:G.message.id}})},[e.id,g,d,h,S,f,y,_,a,t.conversationTurnMountTime,I]);return v.useEffect(()=>nd(Yr,{requestCompletion:M=>{const N=Os(e.id),A=Q.getParentPromptNode(rs(e.id),_);if(!A)throw new Error("Expected prompt for side by side feedback");if(!f||!y)throw new Error("Expected both turns to exist");const T=[f,y].map((p,G)=>{var H,D,$;return{messageId:p.messages[p.messages.length-1].id,loadFirstTokenTime:G===0?a.current.left:a.current.right,loadEndTime:($=(D=(H=B(p.messages))==null?void 0:H.clientMetadata)==null?void 0:D.completionSampleFinishTime)!=null?$:null}}),E=wr({displayedMessages:T,message:A.message,conversationTurnMountTime:t.conversationTurnMountTime,visibilityState:I.current}),R=M.isForSkippingParagen;Ar({params:{conversation_id:N,displayed_message_ids:T.map(p=>p.messageId),message_metadatas:E,rating:R?"explicit_skipped":"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:R?3:1,user_prompt_message_id:A.message.id}}),R&&k(g,{shouldSubmitParagenFeedback:!1})}}),[f,y,_,e.id,t.conversationTurnMountTime,w,h==null?void 0:h.messages,S==null?void 0:S.messages,o,a,k,g,I]),n.jsx(bl,fe(W({},t),{setPreferredFeedback:k,leftVariantId:g,rightVariantId:m,leftTurn:f,rightTurn:y,hasActiveRequest:l,originalTurn:h,visibilityStateRef:I}))}function bl(r){var g=r,{setPreferredFeedback:t,leftVariantId:e,rightVariantId:s,leftTurn:i,rightTurn:a,hasActiveRequest:l,originalTurn:o,visibilityStateRef:d}=g,c=nr(g,["setPreferredFeedback","leftVariantId","rightVariantId","leftTurn","rightTurn","hasActiveRequest","originalTurn","visibilityStateRef"]);var J,Y,ae;const m=(J=i&&Tr(i))!=null?J:null,_=(Y=a&&Tr(a))!=null?Y:null,f=v.useMemo(()=>{var u;return(u=i==null?void 0:i.messages)!=null?u:[]},[i==null?void 0:i.messages]),y=v.useMemo(()=>{var u;return(u=a==null?void 0:a.messages)!=null?u:[]},[a==null?void 0:a.messages]),{avatarClassName:h,firstVisibleTokenTimestampsRef:S}=c,w=v.useMemo(()=>{var u;return(u=i==null?void 0:i.messageGroups)!=null?u:[]},[i==null?void 0:i.messageGroups]),I=v.useMemo(()=>{var u;return(u=a==null?void 0:a.messageGroups)!=null?u:[]},[a==null?void 0:a.messageGroups]),k=xu(),M=rs(c.conversation.id),N=B(i==null?void 0:i.messages),A=B(a==null?void 0:a.messages),T=Wr(Q.getRequestId(M,(ae=N==null?void 0:N.id)!=null?ae:A==null?void 0:A.id)),E=T&&!(N!=null&&N.end_turn),R=T&&!(A!=null&&A.end_turn),p=N!=null&&dr(N),G=A!=null&&dr(A),H=p!=null?p:G,D=(i==null?void 0:i.role)===se.User,$=(a==null?void 0:a.role)===se.User,z=v.useRef(null),K=v.useRef(null),X=v.useRef(null),b=i!=null,U=a!=null;!b&&S.current.left==null&&(S.current.left=Date.now()),!U&&S.current.right==null&&(S.current.right=Date.now()),v.useEffect(()=>{if(z.current&&K.current&&X.current){const u=Array(11).fill(0).map((ee,Z)=>Z/10),ie=new IntersectionObserver(ee=>ee.forEach(Z=>{var ye,le,q,Le,He,je;Z.target===K.current?((le=(ye=d.current).left_visibility_initial)!=null||(ye.left_visibility_initial=Z.intersectionRatio),d.current.left_visibility_max=Math.max((q=d.current.left_visibility_max)!=null?q:0,Z.intersectionRatio)):Z.target===X.current&&((He=(Le=d.current).right_visibility_initial)!=null||(Le.right_visibility_initial=Z.intersectionRatio),d.current.right_visibility_max=Math.max((je=d.current.right_visibility_max)!=null?je:0,Z.intersectionRatio))}),{root:z.current,threshold:u});return ie.observe(K.current),ie.observe(X.current),()=>ie.disconnect()}},[d]),v.useEffect(()=>{const u=K.current,ie=X.current;if(!u||!ie)return;let ee=null;const Z=()=>{ee!=null&&cancelAnimationFrame(ee),ee=requestAnimationFrame(()=>{if(u.isConnected){const le=Math.round(u.getBoundingClientRect().height);d.current.left_rendered_height=le}if(ie.isConnected){const le=Math.round(ie.getBoundingClientRect().height);d.current.right_rendered_height=le}})},ye=new ResizeObserver(Z);return ye.observe(u),ye.observe(ie),Z(),()=>{ee!=null&&cancelAnimationFrame(ee),ye.disconnect()}},[d]);const{data:ne}=_u({includeMemoryEntries:!1,enabled:k});return n.jsxs("div",{className:"relative flex flex-col",children:[n.jsx("div",{className:"bg-token-main-surface-primary sticky z-1 px-(--thread-content-margin) text-center text-lg text-pretty max-md:top-(--header-height)","data-testid":"paragen-feedback-title",children:n.jsx(te,{id:"KKeSJV",defaultMessage:"You're giving feedback on a new version of ChatGPT."})}),n.jsx("div",{className:"text-token-text-secondary px-(--thread-content-margin) pt-1 pb-5 text-center text-sm text-pretty",children:n.jsx(te,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),n.jsx("div",{className:ue(vu(),"horzScrollShadows relative -mb-2 snap-x snap-mandatory overflow-x-auto overflow-y-clip pb-4"),ref:z,children:n.jsxs("div",{className:ue("mx-auto box-content max-w-[calc(2*var(--thread-content-max-width))] min-w-min px-(--thread-content-margin)","flex items-start gap-4 sm:gap-6"),children:[n.jsxs(Ir,{rootElementRef:K,onClick:()=>{t(e)},hasActiveRequest:l,isImageGenInProgress:H,children:[n.jsxs(jr,{children:[n.jsx(ur,{messages:f,isUserTurn:D,avatarClassName:h}),n.jsx(kr,{children:n.jsx(te,fe(W({},Er.responseNumber),{values:{responseIndex:1,display_label:m?" ".concat(m):""}}))})]}),n.jsxs(n.Fragment,{children:[ne!=null&&!D&&n.jsx(br,{clientThreadId:c.conversation.id,messages:f,isParagen:!0}),n.jsx(ri,fe(W({},c),{allMessages:f,groupedMessagesToRender:w,allGroupedMessages:w,isUserTurn:D,isFinalUserTurn:!1,isFinalAssistantTurn:!1,isCompletionRequestInProgress:E,hasActiveRequest:l,shouldGrowContainer:!1,isParagen:!0})),n.jsx(Cr,{clientThreadId:c.conversation.id,conversationTurnMountTime:c.conversationTurnMountTime,turn:i,originalTurn:o})]})]}),n.jsxs(Ir,{rootElementRef:X,onClick:()=>{t(s)},hasActiveRequest:l,isImageGenInProgress:H,children:[n.jsxs(jr,{children:[n.jsx(ur,{messages:y,isUserTurn:$,avatarClassName:h}),n.jsx(kr,{children:n.jsx(te,fe(W({},Er.responseNumber),{values:{responseIndex:2,display_label:_?" ".concat(_):""}}))})]}),n.jsxs(n.Fragment,{children:[ne!=null&&!$&&n.jsx(br,{clientThreadId:c.conversation.id,messages:y,isParagen:!0}),n.jsx(ri,fe(W({},c),{allMessages:y,groupedMessagesToRender:I,allGroupedMessages:I,isFinalUserTurn:!1,isFinalAssistantTurn:!1,isUserTurn:$,isCompletionRequestInProgress:R,hasActiveRequest:l,shouldGrowContainer:!1,isParagen:!0})),n.jsx(Cr,{clientThreadId:c.conversation.id,conversationTurnMountTime:c.conversationTurnMountTime,turn:a,originalTurn:o})]})]})]})})]})}function Ir({rootElementRef:t,onClick:e,children:s,hasActiveRequest:i,isImageGenInProgress:a}){const l=v.useRef(null),o=v.useRef(null),d=v.useRef(null);return n.jsx("div",{"data-paragen-root":!0,className:"border-token-border-tertiary @container relative flex min-w-[min(450px,80cqw,80vw)] flex-1 snap-center flex-col gap-1 rounded-xl border text-start shadow-lg shadow-black/3",ref:t,children:n.jsxs("div",{className:ue(yu,"px-(--thread-content-margin) py-4"),children:[n.jsx("div",{className:ue("absolute top-48 right-0! left-0! h-px","invisible"),ref:l}),n.jsx("div",{className:ue("absolute top-48 right-0! bottom-0 left-0!","invisible"),ref:o}),n.jsx("div",{className:ue("absolute right-0! bottom-0 left-0! h-px","invisible"),ref:d}),s,i||a?null:n.jsx(Jn,{className:"mt-4 self-start",onClick:e,"data-testid":"paragen-prefer-response-button",children:n.jsx(te,{id:"U2EAH6",defaultMessage:"I prefer this response"})})]})})}var Lr;const kr=hi.div(Lr||(Lr=zn(["text-sm text-token-text-secondary font-semibold"])));var Hr;const jr=hi.div(Hr||(Hr=zn(["flex gap-4 items-center mb-1"])));function Cr({clientThreadId:t,conversationTurnMountTime:e,turn:s,originalTurn:i}){var m,_,f,y,h,S;const a=qr();if(!a.showParagenMetadata||!a.showDebugConversationTurns&&!a.forceParagen||s==null)return null;let l=s===i?"ORIGINAL":"NEW";const o=s.messages[s.messages.length-1],d=(m=o==null?void 0:o.metadata)==null?void 0:m.__internal,c=(_=o==null?void 0:o.metadata)==null?void 0:_.paragen_display_label;if(d){const{model_id:w,model_definition_slug:I,model_definition_virtual_model_id:k,alternative_model_selection_rule:M,augmented_paragen_prompt_group_id:N,augmented_paragen_prompt_id:A,augmented_paragen_prompt:T}=d;w&&(l+="\nModel ID: ".concat(w)),I&&(l+="\nModel Slug: ".concat(I)),k&&(l+="\nVirtual Model ID: ".concat(k)),M&&(l+="\nAlternative Model Rule: ".concat(M)),N&&(l+="\nPrompt Group ID: ".concat(N)),A&&(l+="\nPrompt ID: ".concat(A)),T&&(l+="\nPrompt: ".concat(T)),c&&(l+="\nDisplay Label: ".concat(c))}l+="\nMessage ID: ".concat(o.id);const r=Q.getParentPromptNode(rs(t),s.messages[0].id);if(!r)throw new Error("Expected prompt for side by side feedback");const g=((f=r.message.clientMetadata)==null?void 0:f.variantsInStreamInfo)==null&&((y=r.message.metadata)==null?void 0:y.paragen_variants_info)!=null;return l+="\nUser prompt message ID: ".concat(r.message.id),l+="\nIs Persisted Paragen? ".concat(g),l+="\nCompletion Sample Finish Time: ".concat(g?"".concat(e," (persisted)"):(S=(h=B(s.messages))==null?void 0:h.clientMetadata)==null?void 0:S.completionSampleFinishTime),n.jsx("div",{className:"text-sm whitespace-pre-wrap text-red-500",children:l})}async function Ar({params:t}){await ad.safePost("/paragen_submission",{requestBody:t,authOption:id.SendIfAvailable})}const Er=ea({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}{display_label}"}}),Pm=4;function Sl({followups:t,analyticsMetadata:e}){const s=v.useRef(!1),i=_l();v.useEffect(()=>{s.current||(s.current=!0,t.forEach((l,o)=>{ve.logEventWithStatsig("chatgpt_message_followup_action","chatgpt_message_followup_action",fe(W({},Ue(e)),{action:"show",position:(o+1).toString(),followup_text:tt(l)}))}))},[t,e]);const a=t.slice(0,Pm);return n.jsx(Ve.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex w-full flex-col",children:a.map((l,o,d)=>n.jsx(Ve.div,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:o*.03},exit:{opacity:0,translateY:4},children:n.jsx(Mm,{followUp:l,onSelectingSuggestedReply:i,analyticsMetadata:e,position:o,visibleFollowups:d})},o))})}var Dr;const Tl=hi.div(Dr||(Dr=zn(["\n  h-[1px] opacity-45\n  ","\n"])),({$isSelected:t})=>t?"mx-2 bg-token-main-surface-secondary":"bg-token-border-default");function Mm({followUp:t,onSelectingSuggestedReply:e,analyticsMetadata:s,position:i,visibleFollowups:a}){const l=d=>{e(d,t,a,i),ve.logEventWithStatsig("chatgpt_message_followup_action","chatgpt_message_followup_action",fe(W({},Ue(s)),{action:"click",position:(i+1).toString(),followup_text:tt(t)}))},o=()=>{ve.logEventWithStatsig("chatgpt_message_followup_action","chatgpt_message_followup_action",fe(W({},Ue(s)),{action:"hover",position:(i+1).toString(),followup_text:tt(t)}))};return n.jsxs(Ve.button,{whileHover:"hover",className:ue("bg-token-main-surface-primary hover:bg-token-main-surface-secondary flex w-full cursor-pointer items-start justify-start gap-2 rounded-lg px-0 py-3 text-start"),onClick:l,onMouseEnter:o,children:[n.jsx(Ve.div,{className:"flex items-center justify-center pt-0.25 opacity-70",variants:{hover:{x:4}},initial:{x:0},transition:{duration:.1},children:n.jsx(Ds,{className:"text-token-text-secondary icon"})}),n.jsx("div",{className:"text-token-text-secondary pe-2 text-start text-sm",children:tt(t)})]})}const Nm=()=>n.jsx(Qr,{size:"lg",lines:3,width:35,widthVariance:10,className:"w-full"}),Rm=t=>{var s;return(s={[Ne.Search]:"Web Search",[Ne.Research]:"Research",[Ne.PictureV2]:"Draw Image",[Ne.Think]:"Think Harder"}[t])!=null?s:"Title"},li=(t,e,s,i,a)=>{ve.logEventWithStatsig("Capabilities Suggestion Action","chatgpt_capabilities_suggestion_action",fe(W({},Ue(s)),{categoryId:e.categoryId,suggestionId:e.id,position:i,action:t,numSuggestions:String(a)}))},Fm=(t,e)=>{const s=v.useRef(!1);v.useEffect(()=>{s.current||(s.current=!0,t.forEach((i,a)=>{li("show",i,e,a+1,t.length)}))},[t,e])},wl=({suggestions:t,analyticsMetadata:e,style:s="default"})=>{const i=_l();return Fm(t,e),n.jsx(n.Fragment,{children:t.map((a,l)=>n.jsxs(Ve.div,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:4},transition:{delay:l*.03},className:ue("w-full flex-1",s==="compact"&&"flex-col"),children:[s==="compact"&&l>0&&n.jsx(Tl,{$isSelected:!1}),n.jsx(Lm,{suggestion:a,onSelectingSuggestedReply:i,position:l+1,numSuggestions:t.length,analyticsMetadata:e,style:s})]},a.prompt))})},Lm=({suggestion:t,onSelectingSuggestedReply:e,analyticsMetadata:s,position:i,numSuggestions:a,style:l="default"})=>{const{setThreadSystemHintMode:o}=bu(),d=od(),c=di();return n.jsx(Ve.button,{onClick:r=>{if(li("click",t,s,i,a),t.categoryId===Ne.Research)if(d!=null&&d.isFree()){Su(c,"Suggested Capabilities Upsell");return}else o(t.categoryId,!0,s);e(r,t,[],0)},onMouseEnter:()=>{li("hover",t,s,i,a)},className:ue("hover:bg-token-main-surface-secondary flex w-full flex-1 items-start rounded-xl text-start transition-colors duration-300 ease-in-out",l==="default"&&"gap-4 p-2"),children:l==="compact"?n.jsx(Hm,{suggestion:t}):n.jsx(Dm,{suggestion:t})})},Hm=({suggestion:t})=>{var i;const e=_e(()=>Kr()),s=v.useMemo(()=>t.categoryId==="ask"||e==null?void 0:e.find(a=>a.systemHint===t.categoryId),[e,t.categoryId]);return n.jsxs("div",{className:"bg-primary hover:bg-tertiary group flex w-full cursor-pointer items-center justify-start gap-2 rounded-lg px-2 py-3 text-start transition-colors duration-300 ease-in-out",children:[n.jsx("div",{className:"flex items-center justify-center opacity-70 transition-all duration-100 ease-in-out group-hover:scale-[1.02] group-hover:rotate-[-5deg] group-hover:opacity-100",children:t.categoryId==="ask"?n.jsx(Ds,{className:"text-token-text-secondary group-hover:text-token-text-primary icon"}):n.jsx(Xr,{svgString:(i=s==null?void 0:s.logo)!=null?i:"",className:"text-token-text-secondary icon group-hover:text-token-interactive-label-accent-default"})}),n.jsx("div",{className:"text-token-text-secondary group-hover:text-token-text-primary flex items-center pe-2 text-start text-sm",children:tt(t)})]})},Dm=({suggestion:{categoryId:t,imageUrl:e,description:s,title:i,ctaLabel:a,prompt:l}})=>{var c;const o=_e(()=>Kr()),d=v.useMemo(()=>t==="ask"||o==null?void 0:o.find(r=>r.systemHint===t),[o,t]);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"border-token-border-default bg-primary relative h-16 w-14 flex-shrink-0 rounded-lg border drop-shadow-xs transition-all duration-100 ease-in-out group-hover:scale-[1.02] group-hover:rotate-[-2deg]",children:[t===Ne.PictureV2?n.jsx("div",{className:"flex h-full w-full items-center justify-center rounded-lg bg-cover",style:{backgroundImage:"url(".concat(e,")")},children:n.jsx(Tu,{className:"icon-xl mb-2 text-white"})}):n.jsxs("div",{className:"flex flex-col gap-1.5 p-2",children:[n.jsx("div",{className:"text-token-text-primary text-[5px] leading-tight font-semibold tracking-tighter",children:i!=null?i:Rm(t)}),n.jsx("div",{className:"flex flex-col gap-0.5",children:Array.from({length:10}).map((r,g)=>n.jsx("div",{className:"bg-token-border-heavy h-[1px] w-full rounded-full"},g))})]}),n.jsx("div",{className:"absolute -end-2 -bottom-2",children:n.jsx(wu,{isBadge:!0,className:"opacity-100",logo:n.jsx(Xr,{svgString:(c=d==null?void 0:d.logo)!=null?c:"",className:"icon"})})})]}),n.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[n.jsx("div",{className:"text-token-text-primary flex-grow",children:s!=null?s:l}),a&&n.jsxs("div",{className:"text-token-text-secondary flex items-center font-medium",children:[a,n.jsx(Ve.div,{variants:{hover:{x:2}},initial:{x:0},transition:{duration:.1},children:n.jsx(gi,{className:"icon-sm"})})]})]})]})},ci=(t,e,s,i)=>{ve.logEventWithStatsig("Capabilities Tab Action","chatgpt_capabilities_tab_action",fe(W({},Ue(s)),{tabId:e,position:i,action:t}))},Om=(t,e)=>{const s=v.useRef(!1);v.useEffect(()=>{s.current||(s.current=!0,t.forEach((i,a)=>{ci("show",i.value,e,a+1)}))},[t,e])},Bm=({clientThreadId:t,categorySuggestions:e,lastMessageId:s,analyticsMetadata:i,style:a="default"})=>{const l=e.map(({category_id:c,title:r,suggestions:g})=>{var m;return{value:c,message:r,suggestions:(m=g==null?void 0:g.map(cl))!=null?m:[]}}),[o,d]=v.useState(l[0].value);return Om(l,i),n.jsxs(rd,{value:o,onValueChange:d,orientation:"horizontal",className:"flex w-full flex-col",children:[n.jsx(ld,{className:"border-token-border-default relative flex w-full flex-row gap-6 border-b",children:l.map((c,r)=>n.jsx(Vm,{value:c.value,message:c.message,isActive:o===c.value,analyticsMetadata:i,position:r+1},c.value))}),l.map(c=>n.jsx(cd,{value:c.value,children:n.jsx(Um,{initialSuggestions:c.suggestions,clientThreadId:t,categoryId:c.value,isActive:o===c.value,lastMessageId:s,analyticsMetadata:i,style:a})},c.value))]})},Um=({initialSuggestions:t,clientThreadId:e,categoryId:s,isActive:i,lastMessageId:a,analyticsMetadata:l,style:o="default"})=>{const d=Os(e),c=i&&t.length===0,{suggestions:r,isLoading:g}=Iu({categoryId:s,shouldFetch:c,serverThreadId:d,lastMessageId:a}),m=c?r:t;return s==="ask"?g?n.jsx(Nm,{}):n.jsx(Sl,{followups:m.map(_=>({type:dl.Reply,text:_.prompt})),analyticsMetadata:l}):n.jsx("div",{className:"flex w-full flex-col gap-y-4 py-3 md:flex-row md:gap-x-4",children:g?n.jsxs(n.Fragment,{children:[n.jsx(Pr,{}),n.jsx(Pr,{})]}):n.jsx(wl,{suggestions:m,analyticsMetadata:l,style:o})})},Vm=({value:t,message:e,isActive:s,analyticsMetadata:i,position:a})=>n.jsxs(dd,{className:"text-token-text-tertiary hover:text-token-text-secondary radix-state-active:text-token-text-primary relative flex min-w-10 justify-center py-4 text-sm font-medium",value:t,onClick:()=>{ci("click",t,i,a)},onMouseEnter:()=>{ci("hover",t,i,a)},children:[n.jsx("div",{className:"truncate",children:e}),n.jsx(Zn,{children:s&&n.jsx(Ve.div,{layoutId:"tab-underline",className:"bg-token-text-primary absolute start-0 end-0 bottom-0 h-0.5",transition:{type:"spring",stiffness:500,damping:30}})})]}),Pr=()=>n.jsxs("div",{className:"flex flex-1 items-center gap-4 rounded-xl p-2",children:[n.jsx("div",{className:"bg-token-sidebar-surface-secondary dark:bg-token-border-default h-16 w-14 flex-shrink-0 rounded-lg"}),n.jsx("div",{className:"w-full flex-grow",children:n.jsx(Qr,{lines:3,size:"sm"})})]}),Gm=({clientThreadId:t,categorySuggestions:e,lastMessageId:s,analyticsMetadata:i})=>{if(!e||e.length===0)return null;const a=e.length===1,l=e[0],o=l.suggestions.length>0?l.suggestions:void 0;return a&&o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"mb-1 text-sm font-semibold",children:n.jsx(te,{id:"3UFIQc",defaultMessage:"Follow up"})}),n.jsx(wl,{suggestions:o.map(cl),analyticsMetadata:i,style:l.style})]}):n.jsx(Bm,{clientThreadId:t,categorySuggestions:e!=null?e:[],lastMessageId:s,analyticsMetadata:i})},$m=(t,e,s,i,a)=>{ve.logEventWithStatsig("Agent Suggestion Action","chatgpt_agent_suggestion_action",fe(W({},Ue(s)),{capability:e.capability,position:i,action:t,numSuggestions:a}))},Wm=(t,e)=>{const s=v.useRef(!1);v.useEffect(()=>{s.current||(s.current=!0,t.forEach((i,a)=>{$m("show",i,e,a+1,t.length)}))},[t,e])},zm=({agentSuggestions:t,analyticsMetadata:e})=>(Wm(t,e),n.jsx(n.Fragment,{children:t.map((s,i)=>n.jsxs(Ve.div,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:4},transition:{delay:i*.03},className:ue("w-full flex-1","flex-col"),children:[i>0&&n.jsx(Tl,{$isSelected:!1}),n.jsx(qm,{agentSuggestion:s,analyticsMetadata:e})]},s.prompt))})),qm=t=>{"use forget";const e=Ge.c(14),{agentSuggestion:s}=t,i=ud();let a;e[0]!==s.capability?(a=Ym(s.capability),e[0]=s.capability,e[1]=a):a=e[1];const l=a,o=gd();let d;e[2]!==s.prompt||e[3]!==i||e[4]!==o?(d=()=>{const _=md(i);_.focus(),fd(_,s.prompt),o(Ne.Agent)},e[2]=s.prompt,e[3]=i,e[4]=o,e[5]=d):d=e[5];const c=d;let r;e[6]!==l?(r=n.jsx("div",{className:"flex items-center justify-center opacity-70 transition-all duration-100 ease-in-out group-hover:scale-[1.02] group-hover:opacity-100",children:n.jsx(l,{className:"text-token-text-secondary group-hover:text-token-text-primary icon"})}),e[6]=l,e[7]=r):r=e[7];let g;e[8]!==s.title?(g=n.jsx("div",{className:"text-token-text-secondary group-hover:text-token-text-primary flex items-center pe-2 text-start text-sm",children:s.title}),e[8]=s.title,e[9]=g):g=e[9];let m;return e[10]!==c||e[11]!==r||e[12]!==g?(m=n.jsxs("div",{onClick:c,className:"bg-primary hover:bg-tertiary group flex w-full cursor-pointer items-center justify-start gap-2 rounded-lg px-2 py-3 text-start transition-colors duration-300 ease-in-out",children:[r,g]}),e[10]=c,e[11]=r,e[12]=g,e[13]=m):m=e[13],m},Mr={action:ku,research:Ds,spreadsheet:Ds,presentation:Ds,default:Ds},Ym=t=>{var e;return(e=Mr[t])!=null?e:Mr.default};function Qm({clientThreadId:t,followups:e,categorySuggestions:s,actionSuggestions:i,lastMessageId:a,analyticsMetadata:l,isTatertotFollowupsEnabled:o}){const d=Zr(),c=ju.useIsEnabled(t)&&!d,{capabilitySuggestionsEnabled:r}=Cu(o),g=s&&s.length>0;return i&&i.length>0?n.jsx(zm,{agentSuggestions:i,analyticsMetadata:l}):n.jsx(n.Fragment,{children:c&&(r?g&&n.jsx(Gm,{clientThreadId:t,lastMessageId:a,categorySuggestions:s,analyticsMetadata:l}):e.length>0&&n.jsx(Km,{followups:e,analyticsMetadata:l}))})}function Km({followups:t,analyticsMetadata:e}){return n.jsxs("div",{className:"group",children:[n.jsx("hr",{className:"bg-token-bg-tertiary mt-5 mb-5 opacity-70"}),n.jsx(Sl,{followups:t,analyticsMetadata:e})]})}const Xm="Continue",Zm=({clientThreadId:t,messages:e})=>{const s=hd(t),i=v.useMemo(()=>e.some(c=>{var r;return((r=c.metadata)==null?void 0:r.stop_reason)===pd.RiskyDomainNotWatching}),[e]),a=Au(s.id),{selectedSources:l}=Eu(s.id),[o,d]=v.useState(!1);return n.jsx(xd,{testId:"modal-watch-mode-stopped",isOpen:i&&!o,type:"success",size:"normal",onClose:_d,className:"p-1",title:n.jsx("div",{className:"font-semibold",children:n.jsx(te,{id:"8FmSDC",defaultMessage:"Task paused while you were away"})}),primaryButton:n.jsx(Jn,{onClick:()=>{xl({conversation:s,eventSource:"mouse",promptMessage:Br(Xm,W({system_hints:[ir]},l&&{selected_sources:Pu(l)})),completionMetadata:{systemHints:[ir],conversationMode:{kind:ui.PrimaryAssistant}}})},children:n.jsx(te,{id:"4rrYz9",defaultMessage:"Resume"})}),secondaryButton:n.jsx(Jn,{color:"secondary",onClick:()=>d(!0),children:n.jsx(te,{id:"yg+V5e",defaultMessage:"Stay paused"})}),children:n.jsx(te,{id:"Wdb/cy",defaultMessage:"ChatGPT is working with {riskyDomain}, which contains sensitive data. To resume, keep your browser's tab open and monitor actions.",values:{riskyDomain:n.jsx("span",{className:"font-medium",children:a})}})})};function Jm({conversation:t,threadContent:e,query:s,triggeredSearch:i,messageGroups:a,allMessages:l,isAdultSearchEnabled:o}){"use no forget";var ie,ee,Z,ye,le,q,Le,He,je,ls,cs,ds,Je,Gs,us,es,gs;const d=Mu(),c=Nu(s!=null?s:""),r=Ru(s!=null?s:"",o),g=r.safety===mr.ADULT||((ie=e==null?void 0:e.widgets)==null?void 0:ie.safety)==="adult",m=!!r.safeSearchOff||!!((ee=e==null?void 0:e.widgets)!=null&&ee.safe_search_off),_=o===void 0||((Z=e==null?void 0:e.widgets)==null?void 0:Z.safe_search_off)===void 0||((ye=e==null?void 0:e.widgets)==null?void 0:ye.safe_search_off)===o,f=v.useMemo(()=>{var oe;return _?(oe=e==null?void 0:e.widgets)==null?void 0:oe.navlinks:[]},[_,(le=e==null?void 0:e.widgets)==null?void 0:le.navlinks]),y=(q=B(l))==null?void 0:q.id,h=v.useEffectEvent(()=>{fm.set(t,{messageId:y!=null?y:"",safeSearchOff:m!=null?m:!1})});v.useEffect(()=>{!g||!y||h()},[g,y]);const S=c>0&&c<=d&&!r.isNoForceSearch&&r.navlinks.length>0,w=r.isNavlinkIntent===!0||r.safety===mr.ADULT||!!((Le=e==null?void 0:e.widgets)!=null&&Le.is_navlinks_emphasize)||((He=e==null?void 0:e.widgets)==null?void 0:He.safety)==="adult",I=Fu(),[k,M]=v.useState(Yn(si([],f&&f.length>0?f:r.navlinks,!0),I)),[N,A]=v.useState((je=e==null?void 0:e.widgets)!=null&&je.images&&e.widgets.images.length>0?e.widgets.images:r.images),[T,E]=v.useState((ls=e==null?void 0:e.widgets)!=null&&ls.videos&&e.widgets.videos.length>0?e.widgets.videos:r.videos),[R,p]=v.useState((cs=e==null?void 0:e.widgets)!=null&&cs.news&&e.widgets.news.length>0?e.widgets.news:r.news),[G,H]=v.useState({show:!r.isForceHide&&(S||r.isSearchLikely===!0||w||i),showReason:S?Hs.ShortQuery:r.isSearchLikely===!0?Hs.Classifier:i?Hs.Conversation:void 0}),D=v.useRef({navlinks:f&&f.length>0?"thread":r.navlinks.length>0?"prefetched":null,images:(ds=e==null?void 0:e.widgets)!=null&&ds.images&&e.widgets.images.length>0?"thread":r.images.length>0?"prefetched":null,videos:(Je=e==null?void 0:e.widgets)!=null&&Je.videos&&e.widgets.videos.length>0?"thread":r.videos.length>0?"prefetched":null,news:(Gs=e==null?void 0:e.widgets)!=null&&Gs.news&&e.widgets.news.length>0?"thread":r.news.length>0?"prefetched":null}),$=D.current.navlinks==="prefetched"?((es=(us=r.fetchingStatus)==null?void 0:us.navlinks)==null?void 0:es.status)===fr.DONE:((gs=e==null?void 0:e.widgets)==null?void 0:gs.navlinks_ready)===!0,z=k.length>0?k:Yn(r.navlinks,I),K=N.length>0?N:r.images,X=T.length>0?T:r.videos,b=R.length>0?R:r.news,U=!r.isForceHide&&(G.show||r.isSearchLikely===!0||w||i),ne=(oe,$e)=>{const we=Yn(si(k,oe,!0),I,$e);M(we)};v.useEffect(()=>{var we,De,he,Ce,We;if(!r)return;function oe({prefetchedData:ss,threadData:j,sourceType:be,setData:$s,isFinalPrefetched:F,isFinalThread:Ws}){const re=D.current[be];function ot(ts){return Array.isArray(ts)&&ts.length>0}ot(j)&&(!re||re==="thread")?(D.current[be]="thread",$s(j,Ws)):ot(ss)&&(!re||re==="prefetched")&&(D.current[be]="prefetched",$s(ss,F))}oe({prefetchedData:r.navlinks,threadData:f,sourceType:"navlinks",setData:ne,isFinalPrefetched:((De=(we=r.fetchingStatus)==null?void 0:we.navlinks)==null?void 0:De.status)===fr.DONE,isFinalThread:((he=e==null?void 0:e.widgets)==null?void 0:he.navlinks_ready)===!0}),oe({prefetchedData:r.images,threadData:(Ce=e==null?void 0:e.widgets)==null?void 0:Ce.images,sourceType:"images",setData:A}),oe({prefetchedData:r.videos,threadData:(We=e==null?void 0:e.widgets)==null?void 0:We.videos,sourceType:"videos",setData:E}),oe({prefetchedData:r.news,threadData:e==null?void 0:e.widgets.news,sourceType:"news",setData:p}),(r.isSearchLikely||i||S)&&!G.show&&!r.isForceHide&&H({show:!0,showReason:S?Hs.ShortQuery:r.isSearchLikely?Hs.Classifier:Hs.Conversation})},[r,e,i,S]),v.useEffect(()=>{var De;const oe=D.current.navlinks,$e=oe==="prefetched"&&r.safeSearchOff!==o,we=oe==="thread"&&((De=e==null?void 0:e.widgets)==null?void 0:De.safe_search_off)!==o;if(k.length===0&&!r||$e||we){const he=f&&f.length>0,Ce=he?f:r.safeSearchOff===o?r.navlinks:[];if(Ce.length===0)return;D.current.navlinks=he?"thread":"prefetched",M(Yn(si([],Ce,!0),I))}},[r,e,o,f,I,k.length]);const J=U&&z.length>0,Y=Lu(t.id,void 0),ae=Y!==Hu?Y:null,u=v.useMemo(()=>ef(i,a),[i,a]);return{showNavlinksWidget:J,showLongList:w,showReason:G.showReason,isClassifiedAdult:g,isSafeSearchOff:m,navlinksOptimistic:z,navlinksReady:$,imagesOptimistic:K,videosOptimistic:X,newsOptimistic:b,analytics:r.analytics,title:ae,header:u}}function ef(t,e){let s=!1,i,a=-1;for(let o=0;o<e.length;o++)if(e[o].type===Kn.SearchGPTQuery){a=o,s=!0;break}if(s)for(let o=e.length-1;o>a;o--){const d=e[o];if(d.type===Kn.Text||d.type===Kn.CoTSearchTool){i=d.messages[0];break}}return{showSearchGPTQuery:t&&s&&(!i||!vd(i)),nextMessage:i}}const sf=Vs(()=>Us(()=>import("./9c5a2fed-i87mar6blea3r5wu.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])).then(t=>t.MemoryActionResult)),tf=Vs(()=>Us(()=>import("./b18a606b-c6zms491ydufo909.js"),__vite__mapDeps([13,1,2,3,14,4,5])).then(t=>t.AutomationSourceHeader)),Nr=Vs(()=>Us(()=>import("./7f23f398-iphhb0bkgf1z2kvu.js"),__vite__mapDeps([15,1,2,3,16,4,5])).then(t=>t.TextMessageEditor)),nf=Vs(()=>Us(()=>import("./b4a77cb4-c5klrwo0der0fjar.js"),__vite__mapDeps([17,1,2,3,4,5,18,19,20,21,22,23,24])).then(t=>t.ChatScreenRetrievalResultsFlyoutContent)),Rr=80,af=8,Qn=ea({instantAnswerUsed:{id:"CfEuMz",defaultMessage:"Instant Answer Used: {value}"},instantAnswerUsedTrue:{id:"hZZDBk",defaultMessage:"true"},instantAnswerUsedFalse:{id:"uYVmwv",defaultMessage:"false"},instantAnswerCanonicalEntityId:{id:"dVc59l",defaultMessage:"Canonical Entity ID: {value}"}});function ti(){return{minHeight:"calc(100dvh - ".concat($g,"px - 120px)")}}function of({timestampSec:t}){const{formatTime:e}=Bs(),s=new Date(t*1e3),i=e(s,{hour:"numeric",minute:"2-digit"});return n.jsx("div",{className:"text-token-text-tertiary mt-2 mb-1 text-center text-xs",children:i})}function rf(t){"use forget";var Vi,Gi,$i,Wi,zi,qi,Yi,Qi,Ki,Xi,Zi,Ji,eo,so,to,no,ao,io,oo,ro,lo,co,uo,go,mo,fo,ho,po,xo,_o,vo,yo,bo,So,To,wo,Io,ko,jo,Co,Ao,Eo,Po,Mo,No,Ro,Fo,Lo,Ho,Do,Oo,Bo,Uo,Vo,Go,$o,Wo,zo,qo,Yo;const e=Ge.c(358),{turnIndex:s,isFinalTurn:i,conversation:a,onRequestCompletion:l,scrollToMessageId:o,scrollToMessageIsAssistant:d,dateHeaderType:c,hideUserActions:r,disableHorizontalPadding:g}=t,{formatMessage:m}=Bs();let _;e[0]===Symbol.for("react.memo_cache_sentinel")?(_=ul(),e[0]=_):_=e[0];const f=_,y=yd(),h=_e(Yf);let S;e[1]===Symbol.for("react.memo_cache_sentinel")?(S=Zr(),e[1]=S):S=e[1];const w=S,I=Du();let k;e[2]!==I?(k=Ou(I),e[2]=I,e[3]=k):k=e[3];const M=k;let N;e[4]!==I?(N=Bu(I),e[4]=I,e[5]=N):N=e[5];const A=N,{eligible:T}=tl(ii.hasSeenAudioParagenPrompt);let E;e[6]!==s?(E=x=>{var Fe,os,et,st;const C=Q.getConversationTurnAtIndex(x,s),L=s>0?Q.getConversationTurnAtIndex(x,s-1):null,V=(L==null?void 0:L.role)===se.User&&L.messages.some(qf);let Te=!1;const ce=Lg(C);let de=!1,me,ke=null;if(C.role===se.Assistant){const $n=Q.getConversationTurns(x);s+1<$n.length&&Q.getConversationTurnAtIndex(x,s+1).isAsyncCorrection&&(Te=!0),ce&&(de=Hg(C),me=(os=(Fe=B(C.messages))==null?void 0:Fe.metadata)==null?void 0:os.turn_exchange_id);const Ns=C.messages.find(zf),Rs=Ns!=null?Ns:C.messages.find(Wf);Rs&&(ke=(st=(et=Rs.create_time)!=null?et:Rs.update_time)!=null?st:null)}return[C,V,L,Te,ce,de,me,ke]},e[6]=s,e[7]=E):E=e[7];let R;e[8]!==i?(R={disablePerfDetector:i},e[8]=i,e[9]=R):R=e[9];const[p,G,H,D,$,z,K,X]=Be(a.id,E,R),{messages:b,messageGroups:U}=p;let ne;e[10]!==U?(ne=x=>x.size===0?-1:U.findIndex(C=>C.type===xi?C.groups.some(L=>L.messages.some(V=>x.has(V==null?void 0:V.id))):C.messages.some(L=>x.has(L==null?void 0:L.id))),e[10]=U,e[11]=ne):ne=e[11];const J=Uu(ne),Y=b[0];let ae;e[12]!==b?(ae=B(b),e[12]=b,e[13]=ae):ae=e[13];const u=ae;let ie;e[14]!==b?(ie=b.findLast($f),e[14]=b,e[15]=ie):ie=e[15];const ee=ie;let Z;e[16]!==U?(Z=U.some(Gf),e[16]=U,e[17]=Z):Z=e[17];const ye=Z;let le;e[18]!==b?(le=b.some(Vf),e[18]=b,e[19]=le):le=e[19];const q=le;let Le;e[20]!==b?(Le=(Gi=(Vi=B(b))==null?void 0:Vi.metadata)==null?void 0:Gi.chatgpt_sdk_suppressed_response,e[20]=b,e[21]=Le):Le=e[21];const He=Le;let je,ls,cs;if(e[22]!==b||e[23]!==m){const x=b.findLast(Uf),C=(Wi=($i=x==null?void 0:x.metadata)==null?void 0:$i.instant_answer_canonical_entity_id)!=null?Wi:null;je=!!C;let L;if(e[27]!==m||e[28]!==je){const V=m(je?Qn.instantAnswerUsedTrue:Qn.instantAnswerUsedFalse);L=m(Qn.instantAnswerUsed,{value:V}),e[27]=m,e[28]=je,e[29]=L}else L=e[29];ls=L,cs=m(Qn.instantAnswerCanonicalEntityId,{value:C!=null?C:""}),e[22]=b,e[23]=m,e[24]=je,e[25]=ls,e[26]=cs}else je=e[24],ls=e[25],cs=e[26];let ds;e:{if(!q){ds=null;break e}let x;e[30]!==b?(x=b.findLast(Bf),e[30]=b,e[31]=x):x=e[31],ds=x}const Je=ds,Gs=!!((zi=Je==null?void 0:Je.metadata)!=null&&zi.kaur1br5_mode),us=Be(a.id,Of);let es;e[32]!==us||e[33]!==s?(es=()=>hl().isFeedbackViewOpen$()||us&&s===1,e[32]=us,e[33]=s,e[34]=es):es=e[34];const gs=_e(es),oe=J!==-1&&J+1<U.length;let $e;e[35]!==U||e[36]!==J||e[37]!==oe?($e=oe?U.slice(0,J+1):U,e[35]=U,e[36]=J,e[37]=oe,e[38]=$e):$e=e[38];const we=$e;let De;e[39]!==b||e[40]!==we||e[41]!==oe?(De=oe?we.flatMap(Hf):b,e[39]=b,e[40]=we,e[41]=oe,e[42]=De):De=e[42];const he=De;let Ce;e[43]!==he?(Ce=he.filter(bd),e[43]=he,e[44]=Ce):Ce=e[44];let We;e[45]!==he?(We=B(he),e[45]=he,e[46]=We):We=e[46];let ss;e[47]!==we||e[48]!==he||e[49]!==Ce||e[50]!==We?(ss={messages:he,visibleMessages:Ce,messageGroups:we,lastMessageToRender:We},e[47]=we,e[48]=he,e[49]=Ce,e[50]=We,e[51]=ss):ss=e[51];const{messages:j,visibleMessages:be,messageGroups:$s,lastMessageToRender:F}=ss,Ws=J!==-1,re=Be(a.id,Lf),ot=Be(a.id,Ff);let ts;e[52]!==re?(ts=(re==null?void 0:re.includes(Ne.Tatertot))&&Fs("28816792")&&Sd(),e[52]=re,e[53]=ts):ts=e[53];const Il=ts;u==null||u.id;const aa=u==null?void 0:u.id;let rt;e[54]!==a.id||e[55]!==aa||e[56]!==s?(rt={clientThreadId:a.id,turnIndex:s,messageId:aa},e[54]=a.id,e[55]=aa,e[56]=s,e[57]=rt):rt=e[57];const vi=rt,[lt,yi]=v.useState(!1),[bi,kl]=v.useState(!1),jl=v.useContext(Vu)!=null,O=p.role===se.User,zs=Td(),ms=wd(a.id),Se=(qi=p.gizmoId)!=null?qi:ms,Ie=Id(Se).data;let ct;e[58]!==Ie||e[59]!==Se?(ct=Se&&!or(Se)?Ie:void 0,e[58]=Ie,e[59]=Se,e[60]=ct):ct=e[60];const qs=ct,Cl=qs&&p.gizmoId!=null&&p.gizmoId!==ms;let dt;e[61]!==a?(dt=()=>zd(a),e[61]=a,e[62]=dt):dt=e[62];const Ys=_e(dt),Qs=Ys.id,ut=Gu(Ys);let gt;e[63]!==Y.id||e[64]!==(Ie==null?void 0:Ie.gizmo.id)||e[65]!==u||e[66]!==s?(gt=x=>{var et,st,$n,Ns,Rs;const C=Q.getParentPromptNode(x,Y.id),L=(Ns=(et=C==null?void 0:C.message.clientMetadata)==null?void 0:et.variantsInStreamInfo)!=null?Ns:(st=C==null?void 0:C.message.metadata)!=null&&st.paragen_variant_choice||($n=C==null?void 0:C.message.metadata)==null?void 0:$n.paragen_variants_info,V=Q.getVariantIds(x,Y.id),Te=Q.getCurrentVariantId(x,Y.id),ce=Te?V.indexOf(Te):0,de=L&&(x==null?void 0:x.tree)!=null&&V.some(Qo=>{var Xo;const{errType:Ko}=(Xo=x.tree.getLeafFromNode(Qo).message.clientMetadata)!=null?Xo:{};return Ko!=null&&Ko!=="info"}),me=Q.getConversationTurns(x),ke=me.findIndex(Rf),Fe=cr(me,Nf),os=me.slice(ke,s+1).every(Mf);return[C,u!=null&&!qd(u.id)&&Q.isMessageTurnEnded(x,u.id),de,Dg(x==null?void 0:x.mode,Ie==null?void 0:Ie.gizmo.id),me.findIndex(Pf)===s,cr(me,Ef)===s,ke===s,Fe===s,os,Q.getRequestId(x,u==null?void 0:u.id),L,V,ce,!!(x!=null&&x.continuingFromSharedPostId),x==null?void 0:x.currentLeafId,Q.getSuperWidgetMessages(x,s)[0],Q.lastUserMessage(x),(Rs=x==null?void 0:x.continuingFromSharedProjectConversationId)!=null?Rs:null]},e[63]=Y.id,e[64]=Ie==null?void 0:Ie.gizmo.id,e[65]=u,e[66]=s,e[67]=gt):gt=e[67];let mt;e[68]!==i?(mt={disablePerfDetector:i},e[68]=i,e[69]=mt):mt=e[69];const[ge,ia,oa,ft,ra,Si,pe,Ti,Al,wi,ze,Ae,Ks,fs,la,hs,P,El]=Be(a.id,gt,mt),qe=gl();let ht;e[70]!==a?(ht=()=>{const x=Yd(a);return(x==null?void 0:x.value)===Ls.STREAMING||(x==null?void 0:x.value)===Ls.REALTIME||(x==null?void 0:x.value)===Ls.REALTIME_BUSY},e[70]=a,e[71]=ht):ht=e[71];const ps=_e(ht);let pt;e[72]!==j?(pt=j.some(Af),e[72]=j,e[73]=pt):pt=e[73];const Pl=pt;let xt;e[74]===Symbol.for("react.memo_cache_sentinel")?(xt=ei("3119715334").get("should-enable-skip",!1),e[74]=xt):xt=e[74];const Ml=xt;let _t;e[75]===Symbol.for("react.memo_cache_sentinel")?(_t=kd(),e[75]=_t):_t=e[75];const Ii=!_t;let vt;e[76]!==p.messages?(vt=p.messages.map(Cf),e[76]=p.messages,e[77]=vt):vt=e[77];const xs=vt,Oe=v.useRef(null);let yt;e[78]!==a.id||e[79]!==s||e[80]!==p?(yt={clientThreadId:a.id,turn:p,turnIndex:s,conversationTurnWrapperRef:Oe},e[78]=a.id,e[79]=s,e[80]=p,e[81]=yt):yt=e[81],Qf(yt);const Xs=!f&&((Yi=o==null?void 0:o.length)!=null?Yi:0)>2&&o!=="finalAgentTurn"&&i;let bt;e[82]!==O||e[83]!==be?(bt=O?B(be):void 0,e[82]=O,e[83]=be,e[84]=bt):bt=e[84];const Ee=bt,St=Ee==null?void 0:Ee.id;let Tt;e[85]!==a.id||e[86]!==St?(Tt=()=>{St&&(ve.logEvent("Edit Prompt",{id:St,threadId:Os(a.id)}),Xn("chatgpt_edit_prompt"),yi(!0))},e[85]=a.id,e[86]=St,e[87]=Tt):Tt=e[87];const Nl=Tt;let wt;e[88]===Symbol.for("react.memo_cache_sentinel")?(wt=()=>{yi(!1)},e[88]=wt):wt=e[88];const Rl=wt;let It;e[89]!==a.id||e[90]!==Ys?(It={clientThreadId:a.id,currentModelConfig:Ys},e[89]=a.id,e[90]=Ys,e[91]=It):It=e[91];const{onChangeRating:ca}=$u(It);let kt;e[92]!==U||e[93]!==a.id||e[94]!==Qs||e[95]!==h||e[96]!==u||e[97]!==ca?(kt=x=>{var Te;if(!u)return;const C=(Te=u.clientMetadata)==null?void 0:Te.rating,V=(C==="thumbs_up"?"thumbsUp":C==="thumbs_down"?"thumbsDown":C)===x?null:x;if(ca({nodeId:u.id,messageId:u.id,rating:V}),V){const ce=Qd(Kd),de=ce&&U.some(jf),me=ai.isAudioTranscriptMessage(u);ve.logEventWithStatsig(V==="thumbsDown"?"Message Feedback Thumbs Down Clicked":"Message Feedback Thumbs Up Clicked","chatgpt_thumb_feedback",W(W(W({id:u.id,threadId:Os(a.id),model:Qs,rating:V},ce?{isCATriggered:de}:{}),h?{isSidebar:!0}:{}),me?{isVoiceMode:!0}:{}))}kl(V==="thumbsDown")},e[92]=U,e[93]=a.id,e[94]=Qs,e[95]=h,e[96]=u,e[97]=ca,e[98]=kt):kt=e[98];const Fl=kt,[Ll]=v.useState(kf),Pe=jd(a.id),Hl=Pe!=null?Pe:null,ki=(Ki=Pe!=null?Pe:El)!=null?Ki:qe&&(Qi=a.sharedConversationId)!=null?Qi:null,da=(Xi=Wu(a.id))==null?void 0:Xi.value,jt=da===Ls.STREAMING,ua=da===Ls.REALTIME||da===Ls.REALTIME_BUSY,Dl=wi!=null,ga=Wr(wi);let Ct;e[99]!==la?(Ct=x=>hr.isReplayInProgress(x,la),e[99]=la,e[100]=Ct):Ct=e[100];const ma=hr.useState(Ct);let At;e[101]!==b||e[102]!==Ws||e[103]!==ua||e[104]!==jt||e[105]!==i||e[106]!==ia||e[107]!==ma||e[108]!==ga?(At=!ia&&ga||Ws||jt||ua||ma&&i||b.some(If),e[101]=b,e[102]=Ws,e[103]=ua,e[104]=jt,e[105]=i,e[106]=ia,e[107]=ma,e[108]=ga,e[109]=At):At=e[109];const xe=At,Ol=zr(),fa=v.useRef(!1),ji=v.useRef(void 0);let Et;e[110]!==a.id?(Et={clientThreadId:a.id},e[110]=a.id,e[111]=Et):Et=e[111];const Bl=Cd(Et),Ul=zu(a.id,u)&&!Bl&&!!Pe,[,ha]=Or(),{isOpen:ns}=oi(),pa=Jr(),Pt=B(H==null?void 0:H.messages.filter(Ad)),Mt=_e(Ed),xa=Jm({conversation:a,threadContent:(Zi=hs==null?void 0:hs.content)!=null?Zi:null,query:Pt?rr(Pt):null,triggeredSearch:ye,messageGroups:$s,allMessages:b,isAdultSearchEnabled:Mt}),{isClassifiedAdult:Nt,isSafeSearchOff:_a}=xa;let Rt;e[112]!==Mt||e[113]!==Nt||e[114]!==pe||e[115]!==_a||e[116]!==re||e[117]!==p.role?(Rt=()=>[Xd()&&pe&&(!re||re.length===0||re.includes(Ne.Search))&&!Nt,w&&p.role===se.Assistant&&Nt&&_a&&Mt],e[112]=Mt,e[113]=Nt,e[114]=pe,e[115]=_a,e[116]=re,e[117]=p.role,e[118]=Rt):Rt=e[118];const[Vl,va]=_e(Rt),as=(Vl||va)&&xa.showNavlinksWidget;let Ft;e[119]!==j?(Ft=j.filter(lr),e[119]=j,e[120]=Ft):Ft=e[120];const ya=Ft,ba=as&&ya.length===0&&!q,Sa=((Ji=P==null?void 0:P.author.metadata)==null?void 0:Ji.real_author)==="onboarding";let Lt;e[121]!==xs||e[122]!==ha?(Lt=()=>{const C=new URLSearchParams(window.location.search).get("message");!(C!=null&&xs.includes(C))||!Oe.current||(Oe.current.scrollIntoView({behavior:"instant"}),ha(wf,{replace:!0,preventScrollReset:!0}))},e[121]=xs,e[122]=ha,e[123]=Lt):Lt=e[123];const Ta=v.useEffectEvent(Lt);let Ht;e[124]!==Ta?(Ht=()=>{Ta()},e[124]=Ta,e[125]=Ht):Ht=e[125];let Dt;e[126]===Symbol.for("react.memo_cache_sentinel")?(Dt=[],e[126]=Dt):Dt=e[126],v.useEffect(Ht,Dt);let Ot,Bt;e[127]!==o?(Ot=()=>{o!==ji.current&&(fa.current=!1,ji.current=o)},Bt=[o],e[127]=o,e[128]=Ot,e[129]=Bt):(Ot=e[128],Bt=e[129]),v.useEffect(Ot,Bt);let Ut;e[130]!==a||e[131]!==i||e[132]!==pe||e[133]!==pa||e[134]!==Sa||e[135]!==ns||e[136]!==xs||e[137]!==o||e[138]!==d?(Ut=()=>{const L=new URLSearchParams(window.location.search).get("message")!=null;if(fa.current||L||o===void 0||!Oe.current||pa||Sa||w&&pe){o==="finalAgentTurn"&&i&&Ze(a.id,Tf);return}(xs.includes(o)||o==="finalAgentTurn"&&i)&&(fa.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{var V,Te;if(Oe.current)if(o==="finalAgentTurn"&&i){const ce=rs(a.id),de=(V=ce==null?void 0:ce.tree.getNodeIfExists(ce.currentLeafId))==null?void 0:V.message,ke=!!((de==null?void 0:de.channel)=="final"&&((Te=de.metadata)!=null&&Te.mercury_message))?"start":"end";Oe.current.scrollIntoView({behavior:"instant",block:ke}),Ze(a.id,Sf)}else{const{height:ce,paddingTop:de,paddingBottom:me}=getComputedStyle(Oe.current),ke=parseInt(ce)-parseInt(de)-parseInt(me);let Fe=0;ns||d?Fe=-8:ke>Rr&&(Fe=Rr-ke);const os=Og(a).pinnedWidgetHeight$();os!=null&&(Fe=Fe+os),Oe.current.style.scrollMarginTop="".concat(Fe-parseInt(de)+af,"px"),Oe.current.scrollIntoView({behavior:"smooth"})}})}))},e[130]=a,e[131]=i,e[132]=pe,e[133]=pa,e[134]=Sa,e[135]=ns,e[136]=xs,e[137]=o,e[138]=d,e[139]=Ut):Ut=e[139];const wa=v.useEffectEvent(Ut);let Vt;e[140]!==wa?(Vt=()=>{if(!f)return wa()},e[140]=wa,e[141]=Vt):Vt=e[141];let Gt;e[142]!==i||e[143]!==pe||e[144]!==o||e[145]!==d?(Gt=[o,d,pe,f,i],e[142]=i,e[143]=pe,e[144]=o,e[145]=d,e[146]=Gt):Gt=e[146],v.useEffect(Vt,Gt);const{showDebugConversationTurns:Gl,showInstantAnswerDebug:Zf}=qr(),Ia=!qe&&!fs&&!zs&&!O,ka=(F==null?void 0:F.author.role)===se.Assistant?F:null;let $t;e[147]!==((eo=F==null?void 0:F.metadata)==null?void 0:eo.system_hints)?($t=(to=(so=F==null?void 0:F.metadata)==null?void 0:so.system_hints)==null?void 0:to.includes(Ne.Research),e[147]=(no=F==null?void 0:F.metadata)==null?void 0:no.system_hints,e[148]=$t):$t=e[148];const $l=$t;let Wt;e[149]!==((ao=F==null?void 0:F.metadata)==null?void 0:ao.system_hints)?(Wt=(oo=(io=F==null?void 0:F.metadata)==null?void 0:io.system_hints)==null?void 0:oo.includes(Ne.Agent),e[149]=(ro=F==null?void 0:F.metadata)==null?void 0:ro.system_hints,e[150]=Wt):Wt=e[150];const Wl=Wt;let zt;e[151]!==xe||e[152]!==O||e[153]!==ka?(zt={isCompletionRequestInProgress:xe,isUserTurn:O,message:ka},e[151]=xe,e[152]=O,e[153]=ka,e[154]=zt):zt=e[154],qu(zt);const{isOpen:ja}=oi();let qt;e[155]===Symbol.for("react.memo_cache_sentinel")?(qt=Yu(),e[155]=qt):qt=e[155];const zl=qt;let Yt;e[156]!==ft?(Yt=Qu(ft),e[156]=ft,e[157]=Yt):Yt=e[157];const Qe=Yt,ql=Pd(bf),Qt=Pe===ql,Ca=(lo=u==null?void 0:u.metadata)==null?void 0:lo.async_source,_s=i&&Dl,Me=ps||xe||jt,Yl=i&&Me;let Kt;e[158]!==j||e[159]!==be.length?(Kt=be.length===0&&j.some(Md),e[158]=j,e[159]=be.length,e[160]=Kt):Kt=e[160];const Ql=Kt;let Xt;e[161]!==be?(Xt=((co=Xu(be))==null?void 0:co.author.name)===el.A8KM123&&Ku(be,yf),e[161]=be,e[162]=Xt):Xt=e[162];const Aa=Xt,Ea=Zu.useIsMultigenParagenVotingActive();let Zt;e[163]!==j?(Zt=j.some(vf),e[163]=j,e[164]=Zt):Zt=e[164];const Pa=Zt;let Jt;e[165]!==Pa||e[166]!==r||e[167]!==q||e[168]!==ps||e[169]!==fs||e[170]!==lt||e[171]!==i||e[172]!==_s||e[173]!==Qe||e[174]!==Aa||e[175]!==Ea||e[176]!==ja||e[177]!==qe||e[178]!==$||e[179]!==z||e[180]!==Me||e[181]!==He||e[182]!==((uo=u==null?void 0:u.clientMetadata)==null?void 0:uo.isOptimisticPlaceholder)||e[183]!==((go=u==null?void 0:u.metadata)==null?void 0:go.disable_turn_actions)||e[184]!==((mo=u==null?void 0:u.metadata)==null?void 0:mo.is_auto_proceed_message)||e[185]!==((fo=u==null?void 0:u.metadata)==null?void 0:fo.is_takeover_ended_message)||e[186]!==Ca||e[187]!==j||e[188]!==ba||e[189]!==Qt||e[190]!==p.role||e[191]!==p.userContinuationSuccessorTurnId?(Jt=!lt&&!Pa&&!j.every(Nd)&&!qe&&!fs&&!Qe&&!ja&&p.role!==se.Developer&&!(p.role===se.User&&r)&&!(i&&Qt&&Me)&&(!(_s&&Me)||p.role===se.User&&$)&&!(i&&ps&&Ca)&&!(Me&&q)&&!(Aa&&!i)&&!((ho=u==null?void 0:u.metadata)!=null&&ho.is_auto_proceed_message)&&!((po=u==null?void 0:u.metadata)!=null&&po.is_takeover_ended_message)&&!((xo=u==null?void 0:u.metadata)!=null&&xo.disable_turn_actions)&&!((_o=u==null?void 0:u.clientMetadata)!=null&&_o.isOptimisticPlaceholder)&&!z&&!ba&&!p.userContinuationSuccessorTurnId&&!He&&!Ea,e[165]=Pa,e[166]=r,e[167]=q,e[168]=ps,e[169]=fs,e[170]=lt,e[171]=i,e[172]=_s,e[173]=Qe,e[174]=Aa,e[175]=Ea,e[176]=ja,e[177]=qe,e[178]=$,e[179]=z,e[180]=Me,e[181]=He,e[182]=(vo=u==null?void 0:u.clientMetadata)==null?void 0:vo.isOptimisticPlaceholder,e[183]=(yo=u==null?void 0:u.metadata)==null?void 0:yo.disable_turn_actions,e[184]=(bo=u==null?void 0:u.metadata)==null?void 0:bo.is_auto_proceed_message,e[185]=(So=u==null?void 0:u.metadata)==null?void 0:So.is_takeover_ended_message,e[186]=Ca,e[187]=j,e[188]=ba,e[189]=Qt,e[190]=p.role,e[191]=p.userContinuationSuccessorTurnId,e[192]=Jt):Jt=e[192];const Ma=Jt,Kl=!Ma&&!(_s&&Me)&&(qe||fs)&&!h;let en;e[193]!==j?(en=j.some(_f),e[193]=j,e[194]=en):en=e[194];const Xl=en;let sn;e[195]!==Y.id?(sn=x=>{var V,Te;const C=new Set,L=Q.getParentPromptNode(x,Y.id);return(Te=(V=L==null?void 0:L.message.metadata)==null?void 0:V.attachments)==null||Te.forEach(ce=>{var de,me,ke;(de=ce.mime_type)!=null&&de.startsWith("image/")||C.add((ke=(me=ce.context_connector_info)==null?void 0:me.context_connector)!=null?ke:"file")}),C},e[195]=Y.id,e[196]=sn):sn=e[196];const Na=Be(a.id,sn),Ra=Rd(),Fa=Fd("110789670");let vs;Ra.isLoading?vs=void 0:Ra.canUpgradeGDrive&&Na.has(qn.GDRIVE)&&Fa.get("enabled",!1)?vs=qn.GDRIVE:Ra.canUpgradeSharepoint&&Na.has(qn.O365_BUSINESS)&&Fa.get("enabled",!1)?vs=qn.O365_BUSINESS:Na.has("file")&&Fa.get("enabled",!1)&&(vs="general");const Zl=(F==null?void 0:F.author.role)===se.Assistant&&((Io=(wo=(To=F==null?void 0:F.metadata)==null?void 0:To.content_references)==null?void 0:wo.length)!=null?Io:0)>0||ot,Jl=_s&&!xe&&!h&&!qe&&!fs&&!Xl,is=u!=null&&!Qe&&!Ii&&!zs&&!((ko=u.metadata)!=null&&ko.b1de6e2_s);let tn;e[197]===Symbol.for("react.memo_cache_sentinel")?(tn=ei("1030729005").get("chatgpt_message_feedback_consolidation_variant",null),e[197]=tn):tn=e[197];const ec=tn==="all_messages"&&bi,nn=ps||xe,[La,sc]=v.useState(!1),tc=!!((jo=P==null?void 0:P.metadata)!=null&&jo.dictation&&((Co=P==null?void 0:P.metadata)!=null&&Co.dictation_asset_pointer)&&!((Ao=P==null?void 0:P.metadata)!=null&&Ao.dictation_edited));let an;e[198]!==La||e[199]!==T||e[200]!==(P==null?void 0:P.id)||e[201]!==((Eo=P==null?void 0:P.metadata)==null?void 0:Eo.audio_paragen_result)?(an=!T||La||!!((Po=P==null?void 0:P.metadata)!=null&&Po.audio_paragen_result)||pr(P==null?void 0:P.id),e[198]=La,e[199]=T,e[200]=P==null?void 0:P.id,e[201]=(Mo=P==null?void 0:P.metadata)==null?void 0:Mo.audio_paragen_result,e[202]=an):an=e[202];const ys=tc&&!!!an;let on;e[203]!==ys||e[204]!==h||e[205]!==nn||e[206]!==is||e[207]!==pe||e[208]!==ns||e[209]!==P?(on=ys&&is&&!nn&&!h&&!ns&&P!=null&&pe&&Fs("51772912"),e[203]=ys,e[204]=h,e[205]=nn,e[206]=is,e[207]=pe,e[208]=ns,e[209]=P,e[210]=on):on=e[210];const Ci=on,nc=Ju(P==null?void 0:P.id,Ci),Ai=Ci&&nc,Ke=ge==null?void 0:ge.message.id;let rn;e[211]!==h||e[212]!==O||e[213]!==Ke||e[214]!==p.isAsyncCorrection?(rn=!h&&!O&&!p.isAsyncCorrection&&Ke!=null&&Ld(),e[211]=h,e[212]=O,e[213]=Ke,e[214]=p.isAsyncCorrection,e[215]=rn):rn=e[215];const ln=rn;let cn;e[216]!==ln||e[217]!==Ke?(cn=()=>{var x;if(ln){const C=(x=Bg(Ke))==null?void 0:x();if(C&&C.ads_content&&C.ads_content.ads.length>0)return!0}return!1},e[216]=ln,e[217]=Ke,e[218]=cn):cn=e[218];const Ei=_e(cn),ac=Ei&&Ke!=null&&!Yl;let dn;e[219]!==ys||e[220]!==Ia||e[221]!==oa||e[222]!==i||e[223]!==Qe||e[224]!==((No=u==null?void 0:u.clientMetadata)==null?void 0:No.inlineComparisonRating)||e[225]!==(P==null?void 0:P.id)||e[226]!==Ae||e[227]!==(ze==null?void 0:ze.num_variants_in_stream)?(dn=!Qe&&Ia&&i&&(ze==null?void 0:ze.num_variants_in_stream)===2&&Ae.length<=2&&!((Ro=u==null?void 0:u.clientMetadata)!=null&&Ro.inlineComparisonRating)&&!oa&&!ys&&!pr(P==null?void 0:P.id),e[219]=ys,e[220]=Ia,e[221]=oa,e[222]=i,e[223]=Qe,e[224]=(Fo=u==null?void 0:u.clientMetadata)==null?void 0:Fo.inlineComparisonRating,e[225]=P==null?void 0:P.id,e[226]=Ae,e[227]=ze==null?void 0:ze.num_variants_in_stream,e[228]=dn):dn=e[228];const Zs=dn,ic=!Ai&&is&&(_s||i&&Qt||ec)&&!nn&&!h&&!ns&&!Ei&&!q&&!He,Pi=!((xe||ps)&&i)&&Ae.length>1&&!Zs;let un;e[229]!==O||e[230]!==j?(un=O&&j.some(xf),e[229]=O,e[230]=j,e[231]=un):un=e[231];const Mi=un;let gn;e[232]===Symbol.for("react.memo_cache_sentinel")?(gn=ei("2404437118").get("edit_buttons_hidden",!1),e[232]=gn):gn=e[232];const oc=gn&&!Si,rc=O&&Ee!=null&&!((Lo=Ee==null?void 0:Ee.metadata)!=null&&Lo.async_task_id)&&Pe!=null&&!Qe&&!Pl&&!Mi&&!Ii&&!$l&&!Wl&&!h&&!oc;let mn;e[233]!==u?(mn=u!=null&&ai.getAudioAssetPointers(u).length>0,e[233]=u,e[234]=mn):mn=e[234];const Ha=mn;let fn;e[235]!==y||e[236]!==h||e[237]!==Ha||e[238]!==zs||e[239]!==u?(fn=u!=null&&((Do=(Ho=u.clientMetadata)==null?void 0:Ho.disclaimers)!=null?Do:[]).length===0&&!h&&(!zs||Ha)&&!y,e[235]=y,e[236]=h,e[237]=Ha,e[238]=zs,e[239]=u,e[240]=fn):fn=e[240];const lc=fn;let hn;e[241]!==Ks||e[242]!==a.id||e[243]!==(ge==null?void 0:ge.id)||e[244]!==Ae?(hn=x=>{var C;Ze(a.id,L=>{pi.setCurrentBranch(L,Ae[x])}),ve.logEvent("Change Active Node",{intent:"toggle_between"}),Fs("4126691920")&&Ug({parent_prompt_id:(C=ge==null?void 0:ge.id)!=null?C:"",prev_branch_id:Ae[Ks],next_branch_id:Ae[x]},Os(a.id))},e[241]=Ks,e[242]=a.id,e[243]=ge==null?void 0:ge.id,e[244]=Ae,e[245]=hn):hn=e[245],ge==null||ge.id;const Ni=hn,cc=Hd(Dd.accountUserId),pn=Be(a.id,pf);let xn;e[246]!==Se?(xn=Od(Se),e[246]=Se,e[247]=xn):xn=e[247];const dc=!xn||(pn==null?void 0:pn.id)!=null&&pn.id===cc,Ri=eg(p,j,Gl),Fi=q&&sg(j,i),Re=u==null?void 0:u.id;let _n;e[248]!==a||e[249]!==Re||e[250]!==s?(_n=()=>{Re&&v.startTransition(()=>{Vg(a,{type:"retrievalResults",turnIndex:s,messageId:Re})})},e[248]=a,e[249]=Re,e[250]=s,e[251]=_n):_n=e[251];const Da=na(_n);let vn;e[252]!==j?(vn=j.some(hf),e[252]=j,e[253]=vn):vn=e[253];const yn=vn;let bn;e[254]!==j?(bn=j.some(ff),e[254]=j,e[255]=bn):bn=e[255];const uc=bn;let Sn;e[256]!==Se||e[257]!==ut||e[258]!==p?(Sn=tg(p,ut,Se),e[256]=Se,e[257]=ut,e[258]=p,e[259]=Sn):Sn=e[259];const Li=Sn,gc=Li&&!yn;let Tn;e[260]!==Se||e[261]!==M||e[262]!==p?(Tn=ng(p,Se,M),e[260]=Se,e[261]=M,e[262]=p,e[263]=Tn):Tn=e[263];const bs=Tn,Hi=v.useRef(!1);let wn,In;e[264]!==a.id||e[265]!==Re||e[266]!==bs||e[267]!==s?(wn=()=>{!bs||Hi.current||(ve.logEvent("Enhanced Citations Panel Shown",{client_thread_id:a.id,message_id:Re!=null?Re:void 0,turn_index:s}),Hi.current=!0)},In=[a.id,Re,bs,s],e[264]=a.id,e[265]=Re,e[266]=bs,e[267]=s,e[268]=wn,e[269]=In):(wn=e[268],In=e[269]),v.useEffect(wn,In);let kn;e[270]===Symbol.for("react.memo_cache_sentinel")?(kn=Fs("2137702454"),e[270]=kn):kn=e[270];const mc=kn,fc=p.role!==se.User&&ut&&mc&&!yn;let jn;e[271]===Symbol.for("react.memo_cache_sentinel")?(jn=ag(),e[271]=jn):jn=e[271];const{fullScreenEnabled:hc}=jn,pc=Bd()&&CSS.supports("content-visibility: auto")&&!O&&!hc&&(o==null||o==="finalAgentTurn")&&!ig(j);let Cn;e[272]!==j?(Cn=j.some(mf),e[272]=j,e[273]=Cn):Cn=e[273];const Oa=Cn,xc=(Oo=u==null?void 0:u.metadata)==null?void 0:Oo.n7jupd_button_type,_c=q&&u!=null&&u.id!=null&&!xc,vc=q&&i&&Me,yc=q&&i;if(!Ri&&!Zs&&!as)if(Xs){let x;return e[274]===Symbol.for("react.memo_cache_sentinel")?(x=n.jsx("div",{style:ti()}),e[274]=x):x=e[274],x}else return null;if(Fi||G)return null;let An;e[275]!==F?(An=(Bo=F==null?void 0:F.metadata)!=null&&Bo.followup_prompts?F.metadata.followup_prompts.map(gf):[],e[275]=F,e[276]=An):An=e[276];const bc=An,Sc=(Uo=F==null?void 0:F.metadata)==null?void 0:Uo.category_suggestions,Tc=(Vo=F==null?void 0:F.metadata)==null?void 0:Vo.action_suggestions;let En;e[277]!==j?(En=j.some(uf),e[277]=j,e[278]=En):En=e[278];const Ba=En;let Pn;e[279]!==Ba||e[280]!==Oa||e[281]!==gs||e[282]!==y||e[283]!==Pe||e[284]!==ms?(Pn=!Ba&&(!ms||or(ms))&&!Oa&&!y&&!gs&&!!Pe,e[279]=Ba,e[280]=Oa,e[281]=gs,e[282]=y,e[283]=Pe,e[284]=ms,e[285]=Pn):Pn=e[285];const wc=Pn;let Mn;e[286]!==xe||e[287]!==j?(Mn=!xe&&j.some(df),e[286]=xe,e[287]=j,e[288]=Mn):Mn=e[288];const Ic=Mn;let Nn;e[289]!==j?(Nn=j.find(cf),e[289]=j,e[290]=Nn):Nn=e[290];const Ua=Nn,Va=($o=(Go=Ua==null?void 0:Ua.metadata)==null?void 0:Go.onboarding)==null?void 0:$o.examples,Di=!Mi&&(!i||!xe);if(!i&&ya.length===0&&!q&&!as)return null;let Ye="none";O&&ra&&(Ye="first");const kc=H==null?void 0:H.messages.some(lr);if(O&&!ra&&(kc?Ye="large":Ye="none"),D&&(Ye="large-bottom"),i&&(Ye="last"),$&&O&&(Ye="first"),!Ri&&!Zs&&!as)if(Xs){let x;return e[291]===Symbol.for("react.memo_cache_sentinel")?(x=n.jsx("div",{style:ti()}),e[291]=x):x=e[291],x}else return null;if(Fi||G)return null;let Rn;e[292]!==b?(Rn=w?og(b):void 0,e[292]=b,e[293]=Rn):Rn=e[293];const Oi=Rn;if(!i&&ya.length===0&&!q&&!as)return null;let Js;e:{if(p.userContinuationSuccessorTurnId){Js="mb-1";break e}if(O&&!Ma&&!h){Js="mb-10";break e}if(!O&&h&&i){Js="pb-[40px]";break e}Js=void 0}const jc=Js;let Fn;e[294]!==b?(Fn=il(b),e[294]=b,e[295]=Fn):Fn=e[295];const Bi=Fn;let Ln;e[296]!==b?(Ln=nl(b),e[296]=b,e[297]=Ln):Ln=e[297];const Cc=Ln;let Hn;e[298]!==b?(Hn=ol(b),e[298]=b,e[299]=Hn):Hn=e[299];const Ac=Hn;let Dn;e[300]!==b?(Dn=ll(b),e[300]=b,e[301]=Dn):Dn=e[301];const Ec=Dn;let On;e[302]!==b?(On=b.some(rg),e[302]=b,e[303]=On):On=e[303];const Pc=On;let Bn;e[304]!==b?(Bn=b.some(lg),e[304]=b,e[305]=Bn):Bn=e[305];const Mc=Bn;let Un;e[306]!==b?(Un=b.some(cg),e[306]=b,e[307]=Un):Un=e[307];const Nc=Un,Rc=!!Bi,Ui=Ti&&Pc&&!Nc,Ga=Ui&&!Mc&&!Rc,Fc=Ui&&!!Bi;let Vn;e[308]===Symbol.for("react.memo_cache_sentinel")?(Vn=Fs("1480635292"),e[308]=Vn):Vn=e[308];const Lc=Ga&&Vn&&Ec.length>0,Hc=Ga&&!!Ac,Dc=Ga&&Cc.length>0||Fc||Hc,Oc=Fs("2677846117"),$a=Ng,Wa=Mg;let Ss;e[309]!==c||e[310]!==p?(Ss=n.jsx(Gg,{dateHeaderType:c,turn:p}),e[309]=c,e[310]=p,e[311]=Ss):Ss=e[311];let Ts;e[312]!==X||e[313]!==p.role?(Ts=p.role===se.Assistant&&X!=null?n.jsx(of,{timestampSec:X}):null,e[312]=X,e[313]=p.role,e[314]=Ts):Ts=e[314];const za=ue("text-token-text-primary w-full focus:outline-none","[--shadow-height:45px] has-data-writing-block:pointer-events-none has-data-writing-block:-mt-(--shadow-height) has-data-writing-block:pt-(--shadow-height) [&:has([data-writing-block])>*]:pointer-events-auto",pc&&"[content-visibility:auto] supports-[content-visibility:auto]:[contain-intrinsic-size:auto_100lvh]",!f&&o==="finalAgentTurn"?"opacity-0":"",{hidden:jl&&ra},O?"scroll-mt-(--header-height)":"scroll-mt-[calc(var(--header-height)+min(200px,max(70px,20svh)))]"),Bc=-1;let ws;e[315]!==Xs?(ws=Xs?ti():void 0,e[315]=Xs,e[316]=ws):ws=e[316];const Uc="auto",qa="conversation-turn-".concat(s),Ya=!f&&i,Qa=O?"user":"assistant";let Is;e[317]===Symbol.for("react.memo_cache_sentinel")?(Is={},e[317]=Is):Is=e[317];let ks;e[318]!==qs||e[319]!==p.role?(ks=n.jsx(dg,{role:p.role,gizmo:qs}),e[318]=qs,e[319]=p.role,e[320]=ks):ks=e[320];const Ka=Pg,Xa=Eg,Za=Zs||g?"none":"standard",Ja=Zs?n.jsxs(n.Fragment,{children:[n.jsx(Am,W({isFeedbackEnabled:is,variantIds:Ae,conversationTurnMountTime:Ll,currentModelId:Qs},t)),Ml&&n.jsx("div",{className:"mt-4 flex w-full justify-center",children:n.jsxs(Jn,{color:"secondary",className:"text-token-text-primary","data-testid":"paragen-skip-button",onClick:lf,children:[n.jsx(ug,{className:"text-token-text-secondary me-1"}),n.jsx(te,{id:"IuTr+b",defaultMessage:"Skip"})]})})]}):n.jsxs(ml,{tabIndex:-1,className:ue("group/turn-messages focus-visible:outline-hidden",as&&"super-widget-visible",jc,jg({isUserTurn:O})),children:[Cl&&n.jsx(gg,{gizmo:qs}),as&&n.jsx(mg,{clientThreadId:a.id,query:Pt?rr(Pt):null,state:xa,isAssistantResponseSuppressed:!!va}),fc&&n.jsx(fg,{handleShowRetrievalResults:Da,clientThreadId:a.id,turnIndex:s,responseComplete:!Me,className:"mb-6"}),!O&&n.jsx(sf,{messages:j,clientThreadId:a.id,gizmoResource:Ie}),j.some(x=>{var C,L,V;return(V=(C=x.metadata)==null?void 0:C.async_completion_id)!=null?V:O&&((L=x.metadata)==null?void 0:L.async_task_title)})&&!$&&n.jsx(hg,{message:j.find(x=>{var C,L,V;return(V=(C=x.metadata)==null?void 0:C.async_completion_id)!=null?V:O&&x.author.role===se.User&&((L=x.metadata)==null?void 0:L.async_task_title)}),clientThreadId:a.id,isUserTurn:O}),zl&&O&&n.jsx(tf,{clientThreadId:a.id,messages:j}),lt&&Ee?n.jsx(Nr,{message:Ee,clientThreadId:a.id,onRequestCompletion:l,onExitEdit:Rl,disabled:!1}):!va&&n.jsxs(n.Fragment,{children:[!1,n.jsx(ri,fe(W({allMessages:b,groupedMessagesToRender:$s,allGroupedMessages:U},t),{isUserTurn:O,isFinalUserTurn:Si,isFinalAssistantTurn:Ti,isWithinFirstAssistantTurns:Al,isCompletionRequestInProgress:xe,isFeedbackEnabled:is,isFinalTurn:i,isGlauxTurn:yn,isPersonalContextTurn:uc,hasActiveRequest:Ol,isAgentTurn:q,isAsyncCorrectionTurn:p.isAsyncCorrection,isKAUR1BR5:Gs,wasInterrupted:Ql,superWidgetContent:(Wo=hs==null?void 0:hs.content)!=null?Wo:null,lastAgentMetadataNode:Je,hasSearchSystemHint:(zo=re==null?void 0:re.includes(Ne.Search))!=null?zo:!1,isSteeringEnabledTurn:$,isSteeringTurnInProgress:z,turnExchangeId:K}))]}),(gc||I&&bs)&&(I&&bs?n.jsx(nf,{turnIndex:s,clientThreadId:a.id,variant:"bottom"}):n.jsx(xr,{handleShowRetrievalResults:Da,clientThreadId:a.id,turnIndex:s,responseComplete:!Me})),_c&&n.jsx(pg,{message:u,clientThreadId:a.id,turnIndex:s,referenceMessageId:u.id,responseComplete:!i||!xe}),Ic&&n.jsx(gm,{clientThreadId:a.id}),Va&&Va.length>0&&!xe&&n.jsx(mm,{clientThreadId:a.id,examples:Va}),Oi&&n.jsx(xg,{message:Oi,className:"mt-4"}),Ma&&n.jsx(_g,{isUserTurn:O,alwaysShow:!0,children:O?h&&!Oc?null:n.jsx(vg,{activeVariantIndex:Ks,clientThreadId:a.id,numVariants:Ae.length,onAnticipateEdit:Nr.prefetch,onChangeIndex:Ni,onEnterEdit:Nl,showCopyButton:Di,showEditMessageButton:rc,showPagination:Pi,turnIndex:s,reportableMessageId:(qo=Ee==null?void 0:Ee.id)!=null?qo:null,reportableMessageAuthoredByCurrentUser:dc,isSharedConversation:qe,serverThreadIdForReporting:ki}):n.jsxs(n.Fragment,{children:[n.jsx(yg,{activeVariantIndex:Ks,clientThreadId:a.id,conversationMode:ft,lastMessage:u,messages:j,numVariants:Ae.length,onChangeIndex:Ni,onRate:Fl,showCanvasButton:Ul,showCopyButton:Di,showPagination:Pi,showPlayButton:lc,showRatingButtons:is,showRegenerateButton:wc,turn:p,turnIndex:s,parentPrompt:ge,isAgentTurn:q,isKAUR1BR5:Gs,isMostRecentTurn:i,reportableMessageId:(Yo=u==null?void 0:u.id)!=null?Yo:null,isSharedConversation:qe,serverThreadIdForReporting:ki,projectConversationId:Hl}),yn&&Li?n.jsx(xr,{handleShowRetrievalResults:Da,clientThreadId:a.id,turnIndex:s,responseComplete:!Me}):n.jsx(n.Fragment,{children:!A&&n.jsx(_r,{clientThreadId:a.id,message:ee!=null?ee:u,turnIndex:s,isAgentTurn:q})}),!1,Lc&&n.jsx(Cm,{conversation:a,messages:b})]})}),Dc&&n.jsx(Im,{isCompletionRequestInProgress:xe,conversation:a,messages:b}),vc&&n.jsx(bg,{clientThreadId:a.id}),yc&&n.jsx(Zm,{clientThreadId:a.id,messages:j}),Kl&&n.jsx(_r,{clientThreadId:a.id,message:ee!=null?ee:u,turnIndex:s,isAgentTurn:q}),ln&&n.jsx(Zn,{children:ac&&n.jsx(Sg,{conversation:a,userMessageId:Ke})}),!1,ic&&n.jsx(Tg,{canShowInlineMessageFeedback:bi,clientThreadId:a.id,messageForRating:u,allGroupedMessages:U,currentModelId:Qs}),n.jsx(Zn,{mode:"wait",children:Ai&&n.jsx(wg,{lastUserMessageId:P.id,setIsDismissed:sc})}),Jl&&(vs?n.jsx(Ig,{clientThreadId:a.id,connectorToUpsell:vs,analyticsMetadata:vi}):n.jsx(Qm,{followups:bc,actionSuggestions:Tc,categorySuggestions:Sc,clientThreadId:a.id,lastMessageId:Re,analyticsMetadata:vi,isTatertotFollowupsEnabled:Il,shouldHideFollowups:Zl})),$&&Me&&i&&O&&n.jsx(kg,{className:"mt-1"})]});let js;e[321]!==a.id||e[322]!==i||e[323]!==p?(js=n.jsx(Cg,{clientThreadId:a.id,turn:p,isFinalTurn:i}),e[321]=a.id,e[322]=i,e[323]=p,e[324]=js):js=e[324];let Cs;e[325]!==a.id||e[326]!==p?(Cs=n.jsx(Ag,{clientThreadId:a.id,turn:p}),e[325]=a.id,e[326]=p,e[327]=Cs):Cs=e[327];let As;e[328]!==Xa||e[329]!==Za||e[330]!==Ja||e[331]!==js||e[332]!==Cs||e[333]!==Ye?(As=n.jsxs(Xa,{horizontalPadding:Za,verticalPadding:Ye,ref:Oe,children:[Ja,js,Cs]}),e[328]=Xa,e[329]=Za,e[330]=Ja,e[331]=js,e[332]=Cs,e[333]=Ye,e[334]=As):As=e[334];let Es;e[335]!==Ka||e[336]!==As||e[337]!==p.role?(Es=n.jsx(Ka,{role:p.role,children:As}),e[335]=Ka,e[336]=As,e[337]=p.role,e[338]=Es):Es=e[338];let Ps;e[339]!==za||e[340]!==ws||e[341]!==qa||e[342]!==Ya||e[343]!==Qa||e[344]!==Is||e[345]!==ks||e[346]!==Es||e[347]!==p.id?(Ps=n.jsxs("article",fe(W({className:za,tabIndex:Bc,style:ws,dir:Uc,"data-turn-id":p.id,"data-testid":qa,"data-scroll-anchor":Ya,"data-turn":Qa},Is),{children:[ks,Es]})),e[339]=za,e[340]=ws,e[341]=qa,e[342]=Ya,e[343]=Qa,e[344]=Is,e[345]=ks,e[346]=Es,e[347]=p.id,e[348]=Ps):Ps=e[348];let Ms;e[349]!==Wa||e[350]!==Ss||e[351]!==Ts||e[352]!==Ps?(Ms=n.jsxs(Wa,{children:[Ss,Ts,Ps]}),e[349]=Wa,e[350]=Ss,e[351]=Ts,e[352]=Ps,e[353]=Ms):Ms=e[353];let Gn;return e[354]!==pe||e[355]!==Ms||e[356]!==$a.Provider?(Gn=n.jsx($a.Provider,{value:pe,children:Ms}),e[354]=pe,e[355]=Ms,e[356]=$a.Provider,e[357]=Gn):Gn=e[357],Gn}function lf(){Yr.publish({kind:"requestCompletion",isForSkippingParagen:!0})}function cf(t){var e,s;return!!((s=(e=t.metadata)==null?void 0:e.onboarding)!=null&&s.examples)}function df(t){var e,s;return t.author.role===se.Assistant&&((s=(e=t.metadata)==null?void 0:e.onboarding)==null?void 0:s.main_usages)}function uf(t){return ai.getAudioAssetPointers(t).length>0}function gf(t){return{text:t,type:dl.Reply}}function mf(t){var e;return((e=fl(t))==null?void 0:e.canRetry)===!1}function ff(t){return(t==null?void 0:t.recipient)==="q7dr546"}function hf(t){var e,s,i;return((e=t==null?void 0:t.metadata)==null?void 0:e.api_tool_type)==="glaux"||Wd({id:(i=(s=t==null?void 0:t.metadata)==null?void 0:s.model_slug)!=null?i:""})}function pf(t){return t==null?void 0:t.sharedProjectConversationOwner}function xf(t){var e;return(e=fl(t))==null?void 0:e.shouldHideContent}function _f(t){return Gd(t)===$d.l1239dk1}function vf(t){var e,s,i;return t.author.name==="api_tool.call_tool"&&((i=(s=(e=t.metadata)==null?void 0:e.chatgpt_sdk)==null?void 0:s.resource_name)==null?void 0:i.includes("cocoon"))}function yf(t){return t.author.name===el.A8KM123||t.channel==="commentary"||t.author.role===se.Developer}function bf(t){return t.voiceFeedbackThread}function Sf(t){t.scrollToMessageId=void 0}function Tf(t){t.scrollToMessageId=void 0}function wf(t){return t.delete("message"),t}function If(t){return Fg(t)}function kf(){return Date.now()}function jf(t){var e;return t.type!==xi&&((e=t.messages)==null?void 0:e.some(Zd))}function Cf(t){return t.id}function Af(t){return t.content.content_type===Vd.MultimodalText}function Ef(t){return t.role===se.User}function Pf(t){return t.role===se.User}function Mf(t){return t.role===se.Assistant}function Nf(t){return t.role===se.Assistant}function Rf(t){return t.role===se.Assistant}function Ff(t){var e;return(e=t==null?void 0:t.hasIKConvo)!=null?e:!1}function Lf(t){return Q.getLastMessageSystemHints(t)}function Hf(t){return t.type===xi?t.groups.flatMap(Df):t.messages}function Df(t){return t.messages}function Of(t){return!!(t!=null&&t.pulseCardId)}function Bf(t){return t.author.name==="n7jupd.metadata"}function Uf(t){var e;return(e=t.metadata)==null?void 0:e.instant_answer_canonical_entity_id}function Vf(t){var e;return(e=t.metadata)==null?void 0:e.n7jupd_message}function Gf(t){return t.type===Kn.SearchGPTQuery}function $f(t){return Ud(t).length>0}function Wf(t){var e;return(e=t.metadata)==null?void 0:e.proactive_turn}function zf(t){var e;return((e=t.metadata)==null?void 0:e.proactive_turn)&&(t.create_time!=null||t.update_time!=null)}function qf(t){var e;return(e=t.metadata)==null?void 0:e.visually_hide_response_from_conversation}function Yf(){return sl()}const Qf=({clientThreadId:t,turn:e,turnIndex:s,conversationTurnWrapperRef:i})=>{const a=Rg();v.useEffect(()=>{if(!a)return;const l=new IntersectionObserver(o=>{o.forEach(d=>{d.isIntersecting?Ze(t,c=>{var r;c.turnIdsInViewpoint=[...(r=c.turnIdsInViewpoint)!=null?r:[],{turnId:e.id,turnIndex:s,role:e.role}]}):Ze(t,c=>{var r;c.turnIdsInViewpoint=(r=c.turnIdsInViewpoint)==null?void 0:r.filter(({turnId:g})=>g!==e.id)})})},{root:null,threshold:.1});return i.current&&l.observe(i.current),()=>{Ze(t,o=>{var d;o.turnIdsInViewpoint=(d=o.turnIdsInViewpoint)==null?void 0:d.filter(({turnId:c})=>c!==e.id)}),l.disconnect()}},[t,i,a,e.id,e.role,s])},Kf=v.memo(function(e){"use forget";const s=Ge.c(22),{conversation:i,onRequestCompletion:a,disableScrollToMessage:l,hideUserActions:o,disableHorizontalPadding:d}=e;let c;s[0]!==l?(c=h=>[Q.getConversationTurnIds(h),l||h==null?void 0:h.scrollToMessageId,l||h==null?void 0:h.scrollToMessageIsAssistant],s[0]=l,s[1]=c):c=s[1];const[r,g,m]=Be(i.id,c),_=Wg(i.id);let f;if(s[2]!==i||s[3]!==r||s[4]!==d||s[5]!==_||s[6]!==o||s[7]!==a||s[8]!==g||s[9]!==m){let h;s[11]!==i||s[12]!==r.length||s[13]!==d||s[14]!==_||s[15]!==o||s[16]!==a||s[17]!==g||s[18]!==m?(h=(S,w)=>n.jsx(rf,{isFinalTurn:w===r.length-1,turnIndex:w,conversation:i,onRequestCompletion:a,scrollToMessageId:g,scrollToMessageIsAssistant:m,dateHeaderType:_(w),hideUserActions:o,disableHorizontalPadding:d},S),s[11]=i,s[12]=r.length,s[13]=d,s[14]=_,s[15]=o,s[16]=a,s[17]=g,s[18]=m,s[19]=h):h=s[19],f=r.map(h),s[2]=i,s[3]=r,s[4]=d,s[5]=_,s[6]=o,s[7]=a,s[8]=g,s[9]=m,s[10]=f}else f=s[10];let y;return s[20]!==f?(y=n.jsx(n.Fragment,{children:f}),s[20]=f,s[21]=y):y=s[21],y}),Fr=Vs(()=>Us(()=>import("./1de975ca-opfq6f6nav5b4m2m.js"),__vite__mapDeps([25,1,2,3,4,5])).then(t=>t.ThreadReportConversationModal));function _h(t){const{prefetchNavlink:e,clearPrefetchNavlink:s,conversation:i,pageLoadSearchQuery:a}=t,l=ul(),o=zg(i.id),d=qg(),c=Yg(),[r,g]=_e(()=>[Jd(),sl()]),[m]=Qg(),{isOpen:_}=oi(),f=c.store.useContentAreaDimensions(Kg.Header,w=>w!=null&&w.height?w.height:void 0);let y=null;f||(y=!l&&_?"max-sm:pb-25":"pb-25",r?y=m===Xg.Chat?"pb-12":"pb-13":g&&(y="pb-0"));let h=n.jsx(Xf,W({isNewScrollEnabled:l},t));const S=Zg();if(S){const I=eu()?em:sm;h=n.jsx(I,{conversation:i,children:h})}return h=n.jsx(Jg,{clientThreadId:i.id,children:h}),n.jsxs("div",{onCopy:o,className:ue("flex flex-col text-sm",S&&"pt-4",d&&"keyboard-open:pb-[calc(var(--composer-height,100px)+var(--screen-keyboard-height,0))]",y),style:{paddingBottom:f},children:[a&&n.jsx("div",{children:n.jsx(hm,{query:a})}),e?n.jsx(fi,{name:"prefetch-navlink",onError:w=>{ni.addError("Error with prefetch navlink",{error:w}),s()},children:n.jsx(v.Suspense,{fallback:null,children:n.jsx(pm,{clientThreadId:i.id,prefetchNavlink:e,clearPrefetchNavlink:s})})}):null,n.jsx(su,{children:h})]})}function Xf({onRequestCompletion:t,conversation:e,scrollContainerRef:s,isNewScrollEnabled:i=!1}){var I,k,M,N,A;const[a,l,o,d]=Be(e.id,T=>[T==null?void 0:T.pulseCardId,Q.hasUserMessage(T),Q.isMessageTurnEnded(T),T==null?void 0:T.isPotionShare]),c=hl(),r=_e(()=>tm()&&c.isCardViewOpen$()),{data:g}=nm(a),m=a!=null&&!l,_=gl(),f=Jr(),y=tu();am({isSharedConversation:_,clientThreadId:e.id}),v.useEffect(()=>{_&&(Xn("chatgpt_continue_conversation_page_loaded"),ve.logEvent("Continue Conversation: Page Loaded"),Xn("chatgpt_conversation_share_page_loaded"),ve.logEvent("Share Public Chat: Shared Conversation Loaded"))},[_]);const[h,S]=v.useState(!1),w=f&&!y;return n.jsxs(n.Fragment,{children:[w&&n.jsx(um,{}),_&&n.jsxs(n.Fragment,{children:[n.jsx(ml,{children:n.jsx("p",{className:"text-xs text-gray-500",children:d?n.jsx(te,{id:"threadLayout.sharedHealthConversationCopyDisclaimer",defaultMessage:"This is a shared ChatGPT Health conversation. You can't respond or make changes."}):n.jsx(te,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),n.jsx("div",{className:"text-token-text-primary mb-5 text-center text-xs font-semibold",children:n.jsx("button",{onPointerOver:()=>Fr.prefetch(),onClick:()=>{nu(Fr,{clientThreadId:e.id,serverThreadId:e.sharedConversationId,isSharedConversation:!0,isStaticSharedThread:!1}),Xn("chatgpt_conversation_share_report_content_clicked",void 0,{location:"Static Shared Thread Page"}),ve.logEvent("Share Public Chat: Report Content Clicked",{location:"Dynamic Shared Thread Page"})},children:n.jsx(te,{id:"thread.reportSharedConversation",defaultMessage:"Report conversation"})})})]}),g&&n.jsx(im,{imageSrc:(k=(I=g.image)==null?void 0:I.url)!=null?k:"",fallbackSrc:(N=(M=g.image)==null?void 0:M.fallback_url)!=null?N:"",title:(A=g.title)!=null?A:"",cardId:a,hideImage:om(g)==="light"}),n.jsx(rm,{children:n.jsx(Kf,{conversation:e,onRequestCompletion:t,disableScrollToMessage:i||m})}),!i&&n.jsxs(n.Fragment,{children:[r&&(s==null?void 0:s.current)&&n.jsx(au,{setIsScrolledToEdge:T=>{S(!T)},options:{root:s.current,threshold:0,rootMargin:"-30px 0px"}},"pulseCardModalEdgeScrollObserver"),r&&n.jsx(lm,{show:h&&o})]})]})}export{rf as C,_h as T,Kf as a};
//# sourceMappingURL=dbb95ee5-knopp20nqsg0pkxa.js.map
