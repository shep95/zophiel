# Vulnerability Report: Deep Research Feature Leak & Asset Exposure

**Status:** CONFIRMED  
**Severity:** High (Source Code Disclosure + Information Leak)  
**Date:** 2026-01-29  
**Target:** OpenAI "Deep Research" Feature (Unreleased)  

## 1. Executive Summary
A comprehensive OSINT and active reconnaissance campaign has identified multiple vulnerabilities surrounding the unreleased "Deep Research" feature. The primary feature landing page is improperly exposed to unauthenticated users via WAF bypass, leading to a cascade of further information leaks, including **full source code disclosure via Source Maps** and the enumeration of **internal API routes**.

## 2. Consolidated Findings

### Finding A: Unauthenticated Feature Access (WAF Bypass)
- **Description:** The `/features/deep-research/` endpoint returns `200 OK` and serves the full React frontend application to unauthenticated users, while the main `/deep-research` route is correctly gated (`302 Found`).
- **Impact:** Leaks feature existence, marketing copy, and entry points for the unreleased feature.
- **Access Method:** 
  1. Target URL: `https://chatgpt.com/features/deep-research/`
  2. Bypass Technique: Use a TLS-fingerprinted client (e.g., specific `curl` flags) to evade Cloudflare 403 blocks.
  3. Command: `curl -s -L --ssl-no-revoke -H "User-Agent: [Chrome User-Agent]" [URL]`

### Finding B: Source Code Disclosure (Critical)
- **Description:** The JavaScript bundles served by the exposed endpoint have corresponding **Source Map (`.map`) files** that are publicly accessible.
- **Impact:** Allows complete reconstruction of the original, unminified TypeScript source code, including:
  - Developer comments and TODOs.
  - Original variable names and logic structures.
  - Internal data models and type definitions.
- **Access Method:**
  1. Extract JS URLs from the landing page (e.g., `85c26ade-hrz1iksdfqxhc4xf.js`).
  2. Append `.map` to the URL.
  3. Request: `GET https://chatgpt.com/cdn/assets/85c26ade-hrz1iksdfqxhc4xf.js.map` -> Returns `200 OK`.

### Finding C: Internal API Route Disclosure
- **Description:** Static analysis of the leaked JavaScript bundles revealed hardcoded internal API endpoints used by the Deep Research feature.
- **Impact:** Provides a roadmap for attackers to target specific backend services (IDOR, Fuzzing) that may not be fully hardened.
- **Discovered Routes:**
  - `/backend-api/f/conversation` (Primary Deep Research Conversation Endpoint)
  - `/backend-api/sentinel/sdk.js` (Internal Security/Monitoring Tool)
- **Access Method:** 
  1. Download leaked JS bundles.
  2. Run regex scan for `/backend-api/` patterns.

### Finding D: Feature Gate & Configuration Dump
- **Description:** The HTML response contains a full dump of the `window.__remixContext` and `statsigPayload` objects.
- **Impact:** Enumerates over 20 internal feature flags, revealing the rollout strategy and potential "admin" gates.
- **Key Gates:** `pricing_rollout_gate`, `in_shared_projects_gate`, `firewall-gateway`.
- **Access Method:** 
  1. Fetch the `200 OK` HTML response.
  2. Parse the `<script>` tags for JSON dumps.

### Finding E: Internal Header Leak (Infra Disclosure)
- **Description:** Analysis of the leaked JS bundles revealed internal custom HTTP headers used for service-to-service communication.
- **Impact:** Reveals the internal authentication schema and potential bypass vectors for intermediate proxies.
- **Leaked Headers:** 
  - `X-Conduit-Token` (Potential internal auth token)
  - `OAI-Echo-Logs` (Debug logging control)
  - `X-Remix-Revalidate` (Frontend state control)
- **Access Method:** 
  1. Grep downloaded JS bundles for `X-` and `OAI-` patterns.
  2. Confirmed existence in `93527649-d6uunnbv2hve0bim.js`.

### Finding F: Internal Codenames (Project "Sahara")
- **Description:** The source code contains references to "Sahara", a confirmed internal codename associated with the Deep Research initiative.
- **Impact:** Confirms the mapping between public features and internal project teams, aiding in targeted social engineering or further OSINT.
- **Access Method:** 
  1. String search in leaked assets for known project keywords.

## 3. Reproduction Steps (Proof of Concept)

### Step 1: Bypassing the WAF
Standard Python `requests` will be blocked (403). Use the following command to access the exposed landing page:

```bash
curl -s -L --ssl-no-revoke \
  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" \
  -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8" \
  "https://chatgpt.com/features/deep-research/" > DeepResearch_Landing.html
```

### Step 2: Extracting Source Maps
From the downloaded HTML, identify the script tags. Example:
`<script src="/cdn/assets/93527649-d6uunnbv2hve0bim.js"></script>`

Construct the Source Map URL and verify access:
```bash
curl -I "https://chatgpt.com/cdn/assets/93527649-d6uunnbv2hve0bim.js.map"
# Output should be: HTTP/2 200 
```

### Step 3: Mining Secrets
Run the custom extraction tool (included in toolkit) to parse the downloaded assets:
```bash
python Zohar_Toolkit/DeepDive_Phase19_SecretMiner.py
```
*Output will be saved to `Secrets_Report.md`.*

## 4. Remediation Recommendations
1.  **Restrict Source Maps:** Ensure `.map` files are not deployed to public CDNs or are gated behind VPN/Auth.
2.  **Consistency in Auth:** Apply the same authentication middleware to `/features/*` routes as the primary application routes.
3.  **Obfuscation:** Ensure that internal API routes in client-side code are not easily greppable or use dynamic path generation where possible.
